<!doctype html>
<html lang="pt">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-500.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-700.woff2" type="font/woff2" crossorigin>

  <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>

  <link rel="stylesheet" href="https://www.wikiod.com/main.7636753edc6f50e96b0045eba39982b1b0b2b6947250d1080bec1f4cbe52399ea6bcecac0e0b6026886b51bdbde879ec9a9820765b03caead79d8ddf3b79336f.css" integrity="sha512-djZ1PtxvUOlrAEXro5mCsbCytpRyUNEIC&#43;wfTL5SOZ6mvOysDgtgJohrUb296HnsmpggdlsDyurXnY3fO3kzbw==" crossorigin="anonymous">
<noscript><style>img.lazyload { display: none; }</style></noscript>
  <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <title>Práticas recomendadas de VBA - WikiOD</title>
<meta name="description" content="Todos nós os conhecemos, mas essas práticas são muito menos óbvias para quem está começando a programar em VBA.
SEMPRE Use &amp;ldquo;Opção Explícita&amp;rdquo; # Na janela do Editor VBA, no menu Ferramentas, selecione &amp;ldquo;Opções&amp;rdquo;:
Em seguida, na guia &amp;ldquo;Editor&amp;rdquo;, verifique se &amp;ldquo;Exigir declaração de variável&amp;rdquo; está marcado:
Selecionar esta opção colocará automaticamente Option Explicit no topo de cada módulo VBA.
Pequena nota: Isso é verdade para os módulos, módulos de classe, etc.">
  <link rel="canonical" href="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">
<meta property="og:locale" content="pt">
<meta property="og:type" content="article">
<meta property="og:title" content="Práticas recomendadas de VBA">
<meta property="og:description" content="Todos nós os conhecemos, mas essas práticas são muito menos óbvias para quem está começando a programar em VBA.
SEMPRE Use &ldquo;Opção Explícita&rdquo; # Na janela do Editor VBA, no menu Ferramentas, selecione &ldquo;Opções&rdquo;:
Em seguida, na guia &ldquo;Editor&rdquo;, verifique se &ldquo;Exigir declaração de variável&rdquo; está marcado:
Selecionar esta opção colocará automaticamente Option Explicit no topo de cada módulo VBA.
Pequena nota: Isso é verdade para os módulos, módulos de classe, etc.">
<meta property="og:url" content="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">
<meta property="og:site_name" content="WikiOD">

  <meta property="og:image" content="https://www.wikiod.com/wikiod_logo.png"/>
      <meta property="og:image:alt" content="WikiOD">
    
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@wikiod">
<meta name="twitter:creator" content="@wikiod">
<meta name="twitter:title" content="Práticas recomendadas de VBA">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://www.wikiod.com/wikiod_logo.png">
    <meta name="twitter:image:alt" content="Práticas recomendadas de VBA">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
        "@id": "https://www.wikiod.com/#/schema/organization/1",
      "name": "WikiOD",
      "url": "https://www.wikiod.com/",
      "sameAs": [
        "https://twitter.com/wikiod"
        , "https://github.com/wikiod-com"
        ],
      "logo": {
          "@type": "ImageObject",
          "@id": "https://www.wikiod.com/#/schema/image/1",
          "url": "https://www.wikiod.com/wikiod_logo.png",
          "width":  512 ,
          "height":  512 ,
          "caption": "WikiOD"
        },
        "image": {
          "@id": "https://www.wikiod.com/#/schema/image/1"
        }
      },
    {
      "@type": "WebSite",
      "@id": "https://www.wikiod.com/#/schema/website/1",
      "url": "https://www.wikiod.com/",
      "name": "WikiOD",
      "description": "Bem-vindo ao WikiOD - Documentação online do Wiki O WikiOD é um projeto de escrita colaborativa para construir documentação online da mais alta qualidade de todas as linguagens de programação, assuntos e conceitos relacionados à educação.",
      "publisher": {
          "@id": "https://www.wikiod.com/#/schema/organization/1"
        }
      },
    {
      "@type": "WebPage",
      "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/",
      "url": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/",
      "name": "Práticas recomendadas de VBA",
      "description": "",
      "isPartOf": {
        "@id": "https://www.wikiod.com/#/schema/website/1"
      },
      "about": {
          "@id": "https://www.wikiod.com/#/schema/organization/1"
        },
      "datePublished": "0001-01-01T00:00:00CET",
      "dateModified": "0001-01-01T00:00:00CET",
      "breadcrumb": {
        "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/#/schema/breadcrumb/1"
      },
      "primaryImageOfPage": {
        "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/#/schema/image/2"
      },
      "inLanguage": "pt",
      "potentialAction": [{
        "@type": "ReadAction", "target": ["https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/"]
      }]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/#/schema/breadcrumb/1",
      "name": "Breadcrumbs",
      "itemListElement": [{
        "@type": "ListItem",
        "position":  1 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/",
          "url": "https://www.wikiod.com/",
          "name": "Home"
          }
        },{
        "@type": "ListItem",
        "position":  2 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/pt/",
          "url": "https://www.wikiod.com/pt/",
          "name": "Pt"
          }
        },{
        "@type": "ListItem",
        "position":  3 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/pt/excel-vba/",
          "url": "https://www.wikiod.com/pt/excel-vba/",
          "name": "Excel Vba"
          }
        },{
        "@type": "ListItem",
        "position":  4 ,
        "item": {
          "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/"
          }
        }]
    },

    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Article",
          "@id": "https://www.wikiod.com/#/schema/article/1",
          "headline": "Práticas recomendadas de VBA",
          "description": "",
          "isPartOf": {
            "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/"
          },
          "mainEntityOfPage": {
            "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/"
          },
          "datePublished": "0001-01-01T00:00:00CET",
          "dateModified": "0001-01-01T00:00:00CET",
          "author": {
            "@id": "https://www.wikiod.com/#/schema/person/2"
          },
          "publisher": {
              "@id": "https://www.wikiod.com/#/schema/organization/1"
            },
          "image": {
            "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/#/schema/image/2"
          }
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Person",
          "@id": "https://www.wikiod.com/#/schema/person/2",
          "name": "WikiOD",
          "sameAs": [
            "https://twitter.com/wikiod"
            , "https://github.com/wikiod-com"
            ]
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "ImageObject",
          "@id": "https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/#/schema/image/2",
          "url": "https://www.wikiod.com/wikiod_logo.png",
          "contentUrl": "https://www.wikiod.com/wikiod_logo.png",
          "caption": "Práticas recomendadas de VBA"
        }
      ]
    }

  ]
}
</script>

  <meta name="theme-color" content="#fff">
<link rel="icon" href="https://www.wikiod.com/favicon.ico" sizes="any">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.wikiod.com/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.wikiod.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.wikiod.com/favicon-16x16.png">
<link rel="manifest" crossorigin="use-credentials" href="https://www.wikiod.com/site.webmanifest">

  
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9345677191971886" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y7ZZF8Q2L4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y7ZZF8Q2L4');
</script>

</head>

  <body class="docs single">
    <div class="sticky-top">
<div class="header-bar"></div>

<header class="navbar navbar-expand-lg navbar-light doks-navbar">
  <nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation">

    <a class="navbar-brand order-0" href="/pt/" aria-label="WikiOD">
      WikiOD
    </a>

    <button class="btn btn-link order-0 ms-auto d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
    </button>
    <div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
      <div class="header-bar"></div>
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">Navegar docs</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <aside class="doks-sidebar mt-n3">
          <nav id="doks-docs-nav" aria-label="Tertiary navigation">
            

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/pt/docs/excel-vba/"><h3 class="h6 text-uppercase mb-2">tutorial excel-vba</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/introducao-ao-excel-vba/">Introdução ao excel-vba</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">Práticas recomendadas de VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/metodos-para-encontrar-a-ultima-linha-ou-coluna-usada-em-uma-planilha/">Métodos para encontrar a última linha ou coluna usada em uma planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/dicas-e-truques-do-excel-vba/">Dicas e truques do Excel VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/erros-comuns/">Erros comuns</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-e-celulas/">Intervalos e Células</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/depuracao-e-solucao-de-problemas/">Depuração e solução de problemas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/matrizes/">Matrizes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/percorra-todas-as-planilhas-na-pasta-de-trabalho-ativa/">Percorra todas as planilhas na pasta de trabalho ativa</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/funcoes-definidas-pelo-usuario-udfs/">Funções definidas pelo usuário (UDFs)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/tabelas-dinamicas/">Tabelas dinâmicas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/formatacao-condicional-usando-vba/">Formatação condicional usando VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">Otimização Excel-VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/integracao-do-powerpoint-atraves-do-vba/">Integração do PowerPoint através do VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/filtro-automatico-usos-e-boas-praticas/">filtro automático; Usos e boas práticas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/sql-no-excel-vba---praticas-recomendadas/">SQL no Excel VBA - Práticas recomendadas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/vinculativo/">Vinculativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/pastas-de-trabalho/">Pastas de trabalho</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/graficos-e-graficos/">Gráficos e gráficos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/criando-um-menu-suspenso-na-planilha-ativa-com-uma-caixa-de-combinacao/">Criando um menu suspenso na planilha ativa com uma caixa de combinação</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-do-sistema-de-arquivos/">Objeto do sistema de arquivos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/trabalhando-com-tabelas-do-excel-em-vba/">Trabalhando com tabelas do Excel em VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/localizando-valores-duplicados-em-um-intervalo/">Localizando valores duplicados em um intervalo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-nomeados/">Intervalos nomeados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/como-gravar-uma-macro/">Como gravar uma macro</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-de-aplicativo/">Objeto de aplicativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/seguranca-vba/">Segurança VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/celulasintervalos-mesclados/">Célulasintervalos mesclados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/declaracoes-condicionais/">Declarações condicionais</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/use-o-objeto-planilha-e-nao-o-objeto-planilha/">Use o objeto Planilha e não o objeto Planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/customdocumentproperties-na-pratica/">CustomDocumentProperties na prática</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


          </nav>
        </aside>
      </div>
    </div>
    <button class="btn btn-menu order-2 d-block d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDoks" aria-controls="offcanvasDoks" aria-label="Open main menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>
    <div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex="-1" id="offcanvasDoks" data-bs-backdrop="true" aria-labelledby="offcanvasDoksLabel">
      <div class="header-bar d-lg-none"></div>
      <div class="offcanvas-header d-lg-none">
        <h2 class="h5 offcanvas-title ps-2" id="offcanvasDoksLabel"><a class="text-dark" href="/pt/">WikiOD</a></h2>
        <button type="button" class="btn-close text-reset me-2" data-bs-dismiss="offcanvas" aria-label="Close main menu"></button>
      </div>
      <div class="offcanvas-body p-4 p-lg-0">
        <ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto">
              <li class="nav-item">
                <a class="nav-link ps-0 py-1" href="/pt/docs/">Tutoriais</a>
              </li>
            
          
              <li class="nav-item">
                <a class="nav-link ps-0 py-1" href="/pt/blog/">Artigos</a>
              </li>
            
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <ul class="nav flex-column flex-lg-row">
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <button id="mode" class="btn btn-link" type="button" aria-label="Toggle user interface mode">
          <span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
          <span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
        </button>
        <hr class="text-black-50 my-4 d-lg-none">
        <div class="dropdown">
          <button class="btn btn-doks-light dropdown-toggle" id="doks-languages" data-bs-toggle="dropdown" aria-expanded="false" data-bs-display="static">
            Português
            <span class="dropdown-caret"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby="doks-languages">

            <li><a class="dropdown-item current" aria-current="true" href="/pt/excel-vba/praticas-recomendadas-de-vba/">Português</a></li>

            <li><hr class="dropdown-divider"></li>

            
                <li><a class="dropdown-item" rel="alternate" href="/excel-vba/vba-best-practices/" hreflang="en" lang="en">English</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/es/excel-vba/practicas-recomendadas-de-vba/" hreflang="es" lang="es">Español</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/fr/excel-vba/meilleures-pratiques-vba/" hreflang="fr" lang="fr">Français</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/tr/excel-vba/vba-en-iyi-uygulamalar/" hreflang="tr" lang="tr">Türk</a></li>
              
          </ul>
        </div>
        </div>
    </div>
  </nav>
</header>


</div>
<div class="container-xxl">
  <aside class="doks-sidebar">
    <nav id="doks-docs-nav" class="collapse d-lg-none" aria-label="Tertiary navigation">
      

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/pt/docs/excel-vba/"><h3 class="h6 text-uppercase mb-2">tutorial excel-vba</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/introducao-ao-excel-vba/">Introdução ao excel-vba</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">Práticas recomendadas de VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/metodos-para-encontrar-a-ultima-linha-ou-coluna-usada-em-uma-planilha/">Métodos para encontrar a última linha ou coluna usada em uma planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/dicas-e-truques-do-excel-vba/">Dicas e truques do Excel VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/erros-comuns/">Erros comuns</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-e-celulas/">Intervalos e Células</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/depuracao-e-solucao-de-problemas/">Depuração e solução de problemas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/matrizes/">Matrizes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/percorra-todas-as-planilhas-na-pasta-de-trabalho-ativa/">Percorra todas as planilhas na pasta de trabalho ativa</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/funcoes-definidas-pelo-usuario-udfs/">Funções definidas pelo usuário (UDFs)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/tabelas-dinamicas/">Tabelas dinâmicas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/formatacao-condicional-usando-vba/">Formatação condicional usando VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">Otimização Excel-VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/integracao-do-powerpoint-atraves-do-vba/">Integração do PowerPoint através do VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/filtro-automatico-usos-e-boas-praticas/">filtro automático; Usos e boas práticas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/sql-no-excel-vba---praticas-recomendadas/">SQL no Excel VBA - Práticas recomendadas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/vinculativo/">Vinculativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/pastas-de-trabalho/">Pastas de trabalho</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/graficos-e-graficos/">Gráficos e gráficos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/criando-um-menu-suspenso-na-planilha-ativa-com-uma-caixa-de-combinacao/">Criando um menu suspenso na planilha ativa com uma caixa de combinação</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-do-sistema-de-arquivos/">Objeto do sistema de arquivos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/trabalhando-com-tabelas-do-excel-em-vba/">Trabalhando com tabelas do Excel em VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/localizando-valores-duplicados-em-um-intervalo/">Localizando valores duplicados em um intervalo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-nomeados/">Intervalos nomeados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/como-gravar-uma-macro/">Como gravar uma macro</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-de-aplicativo/">Objeto de aplicativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/seguranca-vba/">Segurança VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/celulasintervalos-mesclados/">Célulasintervalos mesclados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/declaracoes-condicionais/">Declarações condicionais</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/use-o-objeto-planilha-e-nao-o-objeto-planilha/">Use o objeto Planilha e não o objeto Planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/customdocumentproperties-na-pratica/">CustomDocumentProperties na prática</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


    </nav>
  </aside>
</div>


    <div class="wrap container-xxl" role="document">
      <div class="content">
        
	<div class="row flex-xl-nowrap">
		<div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block">
			<nav id="sidebar-default" class="docs-links" aria-label="Main navigation">
				

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/pt/docs/excel-vba/"><h3 class="h6 text-uppercase mb-2">tutorial excel-vba</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/introducao-ao-excel-vba/">Introdução ao excel-vba</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">Práticas recomendadas de VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/metodos-para-encontrar-a-ultima-linha-ou-coluna-usada-em-uma-planilha/">Métodos para encontrar a última linha ou coluna usada em uma planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/dicas-e-truques-do-excel-vba/">Dicas e truques do Excel VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/erros-comuns/">Erros comuns</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-e-celulas/">Intervalos e Células</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/depuracao-e-solucao-de-problemas/">Depuração e solução de problemas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/matrizes/">Matrizes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/percorra-todas-as-planilhas-na-pasta-de-trabalho-ativa/">Percorra todas as planilhas na pasta de trabalho ativa</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/funcoes-definidas-pelo-usuario-udfs/">Funções definidas pelo usuário (UDFs)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/tabelas-dinamicas/">Tabelas dinâmicas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/formatacao-condicional-usando-vba/">Formatação condicional usando VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">Otimização Excel-VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/integracao-do-powerpoint-atraves-do-vba/">Integração do PowerPoint através do VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/filtro-automatico-usos-e-boas-praticas/">filtro automático; Usos e boas práticas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/sql-no-excel-vba---praticas-recomendadas/">SQL no Excel VBA - Práticas recomendadas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/vinculativo/">Vinculativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/pastas-de-trabalho/">Pastas de trabalho</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/graficos-e-graficos/">Gráficos e gráficos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/criando-um-menu-suspenso-na-planilha-ativa-com-uma-caixa-de-combinacao/">Criando um menu suspenso na planilha ativa com uma caixa de combinação</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-do-sistema-de-arquivos/">Objeto do sistema de arquivos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/trabalhando-com-tabelas-do-excel-em-vba/">Trabalhando com tabelas do Excel em VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/localizando-valores-duplicados-em-um-intervalo/">Localizando valores duplicados em um intervalo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-nomeados/">Intervalos nomeados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/como-gravar-uma-macro/">Como gravar uma macro</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-de-aplicativo/">Objeto de aplicativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/seguranca-vba/">Segurança VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/celulasintervalos-mesclados/">Célulasintervalos mesclados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/declaracoes-condicionais/">Declarações condicionais</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/use-o-objeto-planilha-e-nao-o-objeto-planilha/">Use o objeto Planilha e não o objeto Planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/customdocumentproperties-na-pratica/">CustomDocumentProperties na prática</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


			</nav>
		</div>
		<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>Nesta página</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#sempre-use-opção-explícita">SEMPRE Use &ldquo;Opção Explícita&rdquo;</a></li>
    <li><a href="#trabalhe-com-arrays-não-com-intervalos">Trabalhe com arrays, não com intervalos</a></li>
    <li><a href="#desligue-as-propriedades-durante-a-execução-da-macro">Desligue as propriedades durante a execução da macro</a></li>
    <li><a href="#use-constantes-vb-quando-disponíveis">Use constantes VB quando disponíveis</a></li>
    <li><a href="#evite-usar-select-ou-activate">Evite usar SELECT ou ACTIVATE</a></li>
    <li><a href="#sempre-defina-e-defina-referências-a-todas-as-pastas-de-trabalho-e-planilhas">Sempre defina e defina referências a todas as pastas de trabalho e planilhas</a></li>
    <li><a href="#use-nomeação-de-variável-descritiva">Use nomeação de variável descritiva</a></li>
    <li><a href="#documente-seu-trabalho">Documente seu trabalho</a></li>
    <li><a href="#manipulação-de-erros">Manipulação de erros</a></li>
  </ul>

  <ul>
    <li><a href="#nunca-assuma-a-planilha">Nunca Assuma A Planilha</a></li>
    <li><a href="#evite-usar-activecell-ou-activesheet-no-excel">Evite usar ActiveCell ou ActiveSheet no Excel</a></li>
    <li><a href="#o-objeto-worksheetfunction-é-executado-mais-rápido-que-um-equivalente-udf">O objeto WorksheetFunction é executado mais rápido que um equivalente UDF</a></li>
    <li><a href="#evite-redefinir-os-nomes-de-propriedades-ou-métodos-como-suas-variáveis">Evite redefinir os nomes de Propriedades ou Métodos como suas variáveis</a></li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>Nesta página</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#sempre-use-opção-explícita">SEMPRE Use &ldquo;Opção Explícita&rdquo;</a></li>
    <li><a href="#trabalhe-com-arrays-não-com-intervalos">Trabalhe com arrays, não com intervalos</a></li>
    <li><a href="#desligue-as-propriedades-durante-a-execução-da-macro">Desligue as propriedades durante a execução da macro</a></li>
    <li><a href="#use-constantes-vb-quando-disponíveis">Use constantes VB quando disponíveis</a></li>
    <li><a href="#evite-usar-select-ou-activate">Evite usar SELECT ou ACTIVATE</a></li>
    <li><a href="#sempre-defina-e-defina-referências-a-todas-as-pastas-de-trabalho-e-planilhas">Sempre defina e defina referências a todas as pastas de trabalho e planilhas</a></li>
    <li><a href="#use-nomeação-de-variável-descritiva">Use nomeação de variável descritiva</a></li>
    <li><a href="#documente-seu-trabalho">Documente seu trabalho</a></li>
    <li><a href="#manipulação-de-erros">Manipulação de erros</a></li>
  </ul>

  <ul>
    <li><a href="#nunca-assuma-a-planilha">Nunca Assuma A Planilha</a></li>
    <li><a href="#evite-usar-activecell-ou-activesheet-no-excel">Evite usar ActiveCell ou ActiveSheet no Excel</a></li>
    <li><a href="#o-objeto-worksheetfunction-é-executado-mais-rápido-que-um-equivalente-udf">O objeto WorksheetFunction é executado mais rápido que um equivalente UDF</a></li>
    <li><a href="#evite-redefinir-os-nomes-de-propriedades-ou-métodos-como-suas-variáveis">Evite redefinir os nomes de Propriedades ou Métodos como suas variáveis</a></li>
  </ul>
</nav>
  </div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="/pt/">Home</a></li>
<li class="breadcrumb-item"><a href="/pt/docs/">Docs</a></li>
<li class="breadcrumb-item"><a href="/pt/docs/excel-vba/">tutorial excel-vba</a></li>
<li class="breadcrumb-item active" aria-current="page">Práticas recomendadas de VBA</li>
					</ol>
				</nav>
			
			<h1>Práticas recomendadas de VBA</h1>
			<p class="lead"></p>
			<nav class="d-xl-none" aria-label="Quaternary navigation">
				<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>Nesta página</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#sempre-use-opção-explícita">SEMPRE Use &ldquo;Opção Explícita&rdquo;</a></li>
    <li><a href="#trabalhe-com-arrays-não-com-intervalos">Trabalhe com arrays, não com intervalos</a></li>
    <li><a href="#desligue-as-propriedades-durante-a-execução-da-macro">Desligue as propriedades durante a execução da macro</a></li>
    <li><a href="#use-constantes-vb-quando-disponíveis">Use constantes VB quando disponíveis</a></li>
    <li><a href="#evite-usar-select-ou-activate">Evite usar SELECT ou ACTIVATE</a></li>
    <li><a href="#sempre-defina-e-defina-referências-a-todas-as-pastas-de-trabalho-e-planilhas">Sempre defina e defina referências a todas as pastas de trabalho e planilhas</a></li>
    <li><a href="#use-nomeação-de-variável-descritiva">Use nomeação de variável descritiva</a></li>
    <li><a href="#documente-seu-trabalho">Documente seu trabalho</a></li>
    <li><a href="#manipulação-de-erros">Manipulação de erros</a></li>
  </ul>

  <ul>
    <li><a href="#nunca-assuma-a-planilha">Nunca Assuma A Planilha</a></li>
    <li><a href="#evite-usar-activecell-ou-activesheet-no-excel">Evite usar ActiveCell ou ActiveSheet no Excel</a></li>
    <li><a href="#o-objeto-worksheetfunction-é-executado-mais-rápido-que-um-equivalente-udf">O objeto WorksheetFunction é executado mais rápido que um equivalente UDF</a></li>
    <li><a href="#evite-redefinir-os-nomes-de-propriedades-ou-métodos-como-suas-variáveis">Evite redefinir os nomes de Propriedades ou Métodos como suas variáveis</a></li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>Nesta página</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#sempre-use-opção-explícita">SEMPRE Use &ldquo;Opção Explícita&rdquo;</a></li>
    <li><a href="#trabalhe-com-arrays-não-com-intervalos">Trabalhe com arrays, não com intervalos</a></li>
    <li><a href="#desligue-as-propriedades-durante-a-execução-da-macro">Desligue as propriedades durante a execução da macro</a></li>
    <li><a href="#use-constantes-vb-quando-disponíveis">Use constantes VB quando disponíveis</a></li>
    <li><a href="#evite-usar-select-ou-activate">Evite usar SELECT ou ACTIVATE</a></li>
    <li><a href="#sempre-defina-e-defina-referências-a-todas-as-pastas-de-trabalho-e-planilhas">Sempre defina e defina referências a todas as pastas de trabalho e planilhas</a></li>
    <li><a href="#use-nomeação-de-variável-descritiva">Use nomeação de variável descritiva</a></li>
    <li><a href="#documente-seu-trabalho">Documente seu trabalho</a></li>
    <li><a href="#manipulação-de-erros">Manipulação de erros</a></li>
  </ul>

  <ul>
    <li><a href="#nunca-assuma-a-planilha">Nunca Assuma A Planilha</a></li>
    <li><a href="#evite-usar-activecell-ou-activesheet-no-excel">Evite usar ActiveCell ou ActiveSheet no Excel</a></li>
    <li><a href="#o-objeto-worksheetfunction-é-executado-mais-rápido-que-um-equivalente-udf">O objeto WorksheetFunction é executado mais rápido que um equivalente UDF</a></li>
    <li><a href="#evite-redefinir-os-nomes-de-propriedades-ou-métodos-como-suas-variáveis">Evite redefinir os nomes de Propriedades ou Métodos como suas variáveis</a></li>
  </ul>
</nav>
  </div>

			</nav>
			<p>Todos nós os conhecemos, mas essas práticas são muito menos óbvias para quem está começando a programar em VBA.</p>
<hr>
<h2 id="sempre-use-opção-explícita">SEMPRE Use &ldquo;Opção Explícita&rdquo; <a href="#sempre-use-op%c3%a7%c3%a3o-expl%c3%adcita" class="anchor" aria-hidden="true">#</a></h2>
<p>Na janela do Editor VBA, no menu Ferramentas, selecione &ldquo;Opções&rdquo;:</p>
<p><a href="http://i.stack.imgur.com/DBq0L.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/DBq0L.png" alt="digite a descrição da imagem aqui"></a></p>
<p>Em seguida, na guia &ldquo;Editor&rdquo;, verifique se &ldquo;Exigir declaração de variável&rdquo; está marcado:</p>
<p><a href="http://i.stack.imgur.com/B3Gam.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/B3Gam.png" alt="digite a descrição da imagem aqui"></a></p>
<p>Selecionar esta opção colocará automaticamente <code>Option Explicit</code> no topo de cada módulo VBA.</p>
<blockquote>
<p><strong>Pequena nota:</strong> Isso é verdade para os módulos, módulos de classe, etc. que não foram abertos até agora. Então, se você já deu uma olhada, por exemplo, o código de <code>Sheet1</code> antes de ativar a opção &ldquo;Require Variable Declaration&rdquo;, <code>Option Explicit</code> não será adicionado!</p>
</blockquote>
<p><code>Option Explicit</code> requer que cada variável tenha que ser definida antes do uso, por exemplo com uma instrução <code>Dim</code>. Sem <code>Option Explicit</code> ativado, qualquer palavra não reconhecida será assumida pelo compilador VBA como uma nova variável do tipo <code>Variant</code>, causando erros extremamente difíceis de detectar relacionados a erros tipográficos. Com a <code>Option Explicit</code> habilitada, qualquer palavra não reconhecida causará um erro de compilação, indicando a linha incorreta.</p>
<p><strong>Exemplo :</strong></p>
<p>Se você executar o seguinte código:</p>
<pre><code>Sub Test()
  my_variable = 12
  MsgBox &quot;My Variable is : &quot; &amp; myvariable
End Sub
</code></pre>
<p>Você receberá a seguinte mensagem:</p>
<p><a href="http://i.stack.imgur.com/DDpmM.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/DDpmM.png" alt="digite a descrição da imagem aqui"></a></p>
<p>Você cometeu um erro escrevendo <code>myvariable</code> em vez de <code>my_variable</code>, então a caixa de mensagem exibe uma variável vazia.
Se você usar <code>Option Explicit</code> , este erro não será possível porque você receberá uma mensagem de erro de compilação indicando o problema.</p>
<p><a href="http://i.stack.imgur.com/0K5UY.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/0K5UY.png" alt="digite a descrição da imagem aqui"></a></p>
<p>Agora, se você adicionar a declaração correta:</p>
<pre><code>Sub Test()
  Dim my_variable As Integer
  my_variable = 12
  MsgBox &quot;My Variable is : &quot; &amp; myvariable
End Sub
</code></pre>
<p>Você obterá uma mensagem de erro indicando precisamente o erro com <code>myvariable</code>:</p>
<p><a href="http://i.stack.imgur.com/Z55Ln.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/Z55Ln.png" alt="digite a descrição da imagem aqui"></a></p>
<hr>
<blockquote>
<p><strong>Nota sobre Option Explicit e Arrays</strong> (<a href="https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/declaring-arrays#declaring-a-dynamic-array">Declarando uma
Matriz</a>):</p>
<p>Você pode usar a instrução ReDim para declarar um array implicitamente dentro
um procedimento.</p>
<ul>
<li>Tenha cuidado para não digitar errado o nome do array ao usar a instrução ReDim</li>
<li>Mesmo que a instrução Option Explicit esteja incluída no módulo, um novo array será criado</li>
</ul>
<p><code>Dim arr() as Long</code></p>
<p><code>ReDim ar() 'cria novo array &quot;ar&quot; - &quot;ReDim ar()&quot; age como &quot;Dim ar()&quot;</code></p>
</blockquote>
<h2 id="trabalhe-com-arrays-não-com-intervalos">Trabalhe com arrays, não com intervalos <a href="#trabalhe-com-arrays-n%c3%a3o-com-intervalos" class="anchor" aria-hidden="true">#</a></h2>
<p><a href="http://i.stack.imgur.com/DBq0L.png">Blog do Office - Práticas recomendadas de codificação de desempenho do Excel VBA</a></p>
<p>Muitas vezes, o melhor desempenho é alcançado evitando o uso de <code>Range</code> tanto quanto possível. Neste exemplo, lemos um objeto <code>Range</code> inteiro em um array, elevamos ao quadrado cada número no array e, em seguida, retornamos o array de volta ao <code>Range</code>. Isso acessa <code>Range</code> apenas duas vezes, enquanto um loop acessaria 20 vezes para leitura/gravação.</p>
<pre><code>Option Explicit
Sub WorkWithArrayExample()
    
Dim DataRange As Variant
Dim Irow As Long
Dim Icol As Integer
DataRange = ActiveSheet.Range(&quot;A1:A10&quot;).Value ' read all the values at once from the Excel grid, put into an array

For Irow = LBound(DataRange,1) To UBound(DataRange, 1) ' Get the number of rows.
  For Icol = LBound(DataRange,2) To UBound(DataRange, 2) ' Get the number of columns.
    DataRange(Irow, Icol) = DataRange(Irow, Icol) * DataRange(Irow, Icol) ' cell.value^2
  Next Icol
Next Irow
ActiveSheet.Range(&quot;A1:A10&quot;).Value = DataRange ' writes all the results back to the range at once
    
End Sub
</code></pre>
<p>Mais dicas e informações com exemplos cronometrados podem ser encontradas em [Escrevendo UDFs VBA eficientes de Charles Williams (Parte 1)](https://fastexcel.wordpress.com/2011/05/25/writing-efficient-vba-udfs-part- 1/) e <a href="https://fastexcel.wordpress.com/page/2/?s=writing+eficiente">outros artigos da série</a>.</p>
<h2 id="desligue-as-propriedades-durante-a-execução-da-macro">Desligue as propriedades durante a execução da macro <a href="#desligue-as-propriedades-durante-a-execu%c3%a7%c3%a3o-da-macro" class="anchor" aria-hidden="true">#</a></h2>
<p>É uma prática recomendada em qualquer linguagem de programação <strong>evitar a otimização prematura.</strong> No entanto, se o teste revelar que seu código está sendo executado muito lentamente, você poderá ganhar velocidade desativando algumas das propriedades do aplicativo enquanto ele é executado. Adicione este código a um módulo padrão:</p>
<pre><code>Public Sub SpeedUp( _
    SpeedUpOn As Boolean, _
    Optional xlCalc as XlCalculation = xlCalculationAutomatic _
)
    With Application
        If SpeedUpOn Then
            .ScreenUpdating = False
            .Calculation = xlCalculationManual
            .EnableEvents = False
            .DisplayStatusBar = False 'in case you are not showing any messages
            ActiveSheet.DisplayPageBreaks = False 'note this is a sheet-level setting
        Else
            .ScreenUpdating = True
            .Calculation = xlCalc
            .EnableEvents = True
            .DisplayStatusBar = True
            ActiveSheet.DisplayPageBreaks = True
        End If
    End With
End Sub
</code></pre>
<p><em>Mais informações em <a href="https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/">Blog do Office - Excel VBA Performance Coding Best Practices</a></em></p>
<p>E basta chamá-lo no início e no final das macros:</p>
<pre><code>Public Sub SomeMacro
    'store the initial &quot;calculation&quot; state
    Dim xlCalc As XlCalculation
    xlCalc = Application.Calculation

    SpeedUp True

    'code here ...

    'by giving the second argument the initial &quot;calculation&quot; state is restored
    'otherwise it is set to 'xlCalculationAutomatic'
    SpeedUp False, xlCalc
End Sub
</code></pre>
<p>Embora estes possam ser considerados &ldquo;melhorias&rdquo; para procedimentos regulares de <code>Public Sub</code>, desabilitar o tratamento de eventos com <code>Application.EnableEvents = False</code> deve ser considerado obrigatório para macros de eventos privados <code>Worksheet_Change</code> e <code>Workbook_SheetChange</code> que alteram valores em um ou mais fichas de trabalho. A falha em desabilitar os gatilhos de evento fará com que a macro de evento seja executada recursivamente sobre si mesma quando um valor for alterado e pode levar a uma pasta de trabalho &ldquo;congelada&rdquo;. Lembre-se de reativar os eventos antes de sair da macro de eventos, possivelmente por meio de um manipulador de erro de &ldquo;saída segura&rdquo;.</p>
<pre><code>Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Range(&quot;A:A&quot;)) Is Nothing Then
        On Error GoTo bm_Safe_Exit
        Application.EnableEvents = False
        
        'code that may change a value on the worksheet goes here
        
    End If
bm_Safe_Exit:
    Application.EnableEvents = True
End Sub
</code></pre>
<p><strong>Uma ressalva:</strong> embora a desativação dessas configurações melhore o tempo de execução, elas podem dificultar muito a depuração do seu aplicativo. Se o seu código <em>não</em> estiver funcionando corretamente, comente a chamada <code>SpeedUp True</code> até descobrir o problema.</p>
<p>Isso é particularmente importante se você estiver gravando em células em uma planilha e, em seguida, lendo os resultados calculados das funções da planilha, pois o <code>xlCalculationManual</code> impede que a pasta de trabalho calcule. Para contornar isso sem desabilitar o <code>SpeedUp</code>, você pode querer incluir <code>Application.Calculate</code> para executar um cálculo em pontos específicos.</p>
<p><strong>OBSERVAÇÃO:</strong> como essas são propriedades do próprio <code>Aplicativo</code>, você precisa garantir que elas sejam habilitadas novamente antes que sua macro seja encerrada. Isso torna particularmente importante usar manipuladores de erros e evitar vários pontos de saída (ou seja, <code>End</code> ou <code>Unload Me</code>).</p>
<p>Com tratamento de erros:</p>
<pre><code>Public Sub SomeMacro()
    'store the initial &quot;calculation&quot; state
    Dim xlCalc As XlCalculation
    xlCalc = Application.Calculation

    On Error GoTo Handler
    SpeedUp True
    
    'code here ...
    i = 1 / 0
CleanExit:
    SpeedUp False, xlCalc
    Exit Sub
Handler:
    'handle error
    Resume CleanExit
End Sub
</code></pre>
<h2 id="use-constantes-vb-quando-disponíveis">Use constantes VB quando disponíveis <a href="#use-constantes-vb-quando-dispon%c3%adveis" class="anchor" aria-hidden="true">#</a></h2>
<pre><code>If MsgBox(&quot;Click OK&quot;) = vbOK Then
</code></pre>
<p>pode ser usado no lugar de</p>
<pre><code>If MsgBox(&quot;Click OK&quot;) = 1 Then
</code></pre>
<p>para melhorar a legibilidade.</p>
<hr>
<p>Use o <em>Object Browser</em> para encontrar as constantes VB disponíveis. <em>Visualizar → Navegador de Objetos</em> ou <kbd>F2</kbd> do Editor VB.</p>
<p><a href="http://i.stack.imgur.com/DBq0L.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/DBq0L.png" alt="digite a descrição da imagem aqui"></a></p>
<p>Digite a turma para pesquisar</p>
<p><a href="http://i.stack.imgur.com/B3Gam.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/B3Gam.png" alt="digite a descrição da imagem aqui"></a></p>
<p>Ver membros disponíveis</p>
<p><a href="http://i.stack.imgur.com/DDpmM.png"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/DDpmM.png" alt="digite a descrição da imagem aqui"></a></p>
<h2 id="evite-usar-select-ou-activate">Evite usar SELECT ou ACTIVATE <a href="#evite-usar-select-ou-activate" class="anchor" aria-hidden="true">#</a></h2>
<p>É <strong>muito</strong> raro que você queira usar <code>Select</code> ou <code>Activate</code> em seu código, mas alguns métodos do Excel exigem que uma planilha ou pasta de trabalho seja ativada antes de funcionarem conforme o esperado.</p>
<p>Se você está apenas começando a aprender VBA, muitas vezes será sugerido que você grave suas ações usando o gravador de macro e, em seguida, dê uma olhada no código. Por exemplo, gravei as ações tomadas para inserir um valor na célula D3 na Planilha2 e o código da macro se parece com isso:</p>
<pre><code>Option Explicit
Sub Macro1()
'
' Macro1 Macro
'

'
    Sheets(&quot;Sheet2&quot;).Select
    Range(&quot;D3&quot;).Select
    ActiveCell.FormulaR1C1 = &quot;3.1415&quot;   '(see **note below)
    Range(&quot;D4&quot;).Select
End Sub
</code></pre>
<p>Lembre-se, porém, que o gravador de macro cria uma linha de código para CADA uma de suas ações (do usuário). Isso inclui clicar na guia da planilha para selecionar Sheet2 (<code>Sheets(&quot;Sheet2&quot;).Select</code>), clicar na célula D3 antes de inserir o valor (<code>Range(&quot;D3&quot;).Select</code>) e usar a tecla Enter ( que está efetivamente &ldquo;selecionando&rdquo; a célula abaixo da célula selecionada: <code>Range(&quot;D4&quot;).Select</code>).</p>
<p>Existem vários problemas com o uso de <code>.Select</code> aqui:</p>
<ul>
<li><strong>A planilha nem sempre é especificada.</strong> Isso acontece se você não trocar as planilhas durante a gravação e significa que o código produzirá resultados diferentes para diferentes planilhas ativas.</li>
<li><strong><code>.Select()</code> é lento.</strong> Mesmo se <code>Application.ScreenUpdating</code> estiver definido como <code>False</code>, esta é uma operação desnecessária a ser processada.</li>
<li><strong><code>.Select()</code> é incontrolável.</strong> Se <code>Application.ScreenUpdating</code> for deixado para <code>True</code>, o Excel irá selecionar as células, a planilha, o formulário&hellip; o que quer que você esteja trabalhando . Isso é estressante para os olhos e muito desagradável de assistir.</li>
<li><strong><code>.Select()</code> irá acionar ouvintes.</strong> Isso já é um pouco avançado, mas a menos que seja resolvido, funções como <code>Worksheet_SelectionChange()</code> serão acionadas.</li>
</ul>
<p>Quando você está codificando em VBA, todas as ações de &ldquo;digitação&rdquo; (ou seja, instruções <code>Select</code>) não são mais necessárias. Seu código pode ser reduzido a uma única instrução para colocar o valor na célula:</p>
<pre><code>'--- GOOD
ActiveWorkbook.Sheets(&quot;Sheet2&quot;).Range(&quot;D3&quot;).Value = 3.1415

'--- BETTER
Dim myWB      As Workbook
Dim myWS      As Worksheet
Dim myCell    As Range

Set myWB = ThisWorkbook             '*** see NOTE2
Set myWS = myWB.Sheets(&quot;Sheet2&quot;)
Set myCell = myWS.Range(&quot;D3&quot;)

myCell.Value = 3.1415
</code></pre>
<p>(O exemplo BETTER acima mostra o uso de variáveis ​​intermediárias para separar diferentes partes da referência de célula. O exemplo GOOD sempre funcionará bem, mas pode ser muito complicado em módulos de código muito mais longos e mais difícil de depurar se uma das referências for digitada incorretamente. )</p>
<p>**NOTA: o gravador de macro faz muitas suposições sobre o tipo de dados que você está inserindo, neste caso, inserindo um valor de string como uma fórmula para criar o valor. Seu código não precisa fazer isso e pode simplesmente atribuir um valor numérico diretamente à célula, conforme mostrado acima.</p>
<p>**NOTA2: a prática recomendada é definir sua variável de pasta de trabalho local para <code>ThisWorkbook</code> em vez de <code>ActiveWorkbook</code> (a menos que você precise explicitamente dela). O motivo é que sua macro geralmente precisará/usar recursos em qualquer pasta de trabalho que o código VBA origine e NÃO procurará fora dessa pasta de trabalho - novamente, a menos que você direcione explicitamente seu código para trabalhar com outra pasta de trabalho. Quando você tem várias pastas de trabalho abertas no Excel, a &lsquo;ActiveWorkbook&rsquo; é aquela com o foco <em>que pode ser diferente da pasta de trabalho que está sendo visualizada no seu Editor VBA</em>. Então você acha que está executando em uma pasta de trabalho quando na verdade está referenciando outra. <code>ThisWorkbook</code> refere-se à pasta de trabalho que contém o código que está sendo executado.</p>
<h2 id="sempre-defina-e-defina-referências-a-todas-as-pastas-de-trabalho-e-planilhas">Sempre defina e defina referências a todas as pastas de trabalho e planilhas <a href="#sempre-defina-e-defina-refer%c3%aancias-a-todas-as-pastas-de-trabalho-e-planilhas" class="anchor" aria-hidden="true">#</a></h2>
<p>Ao trabalhar com várias pastas de trabalho abertas, cada uma das quais pode ter várias planilhas, é mais seguro definir e definir referência a todas as pastas de trabalho e planilhas.</p>
<p><strong>Não confie</strong> em <code>ActiveWorkbook</code> ou <code>ActiveSheet</code>, pois eles podem ser alterados pelo usuário.</p>
<p>O exemplo de código a seguir demonstra como copiar um intervalo da planilha “<em>Raw_Data</em>” na pasta de trabalho “<em>Data.xlsx</em>” para a planilha “<em>Refined_Data</em>” na pasta de trabalho “<em>Results.xlsx</em>”.</p>
<p>O procedimento também demonstra como copiar e colar sem usar o método <code>Select</code>.</p>
<pre><code>Option Explicit

Sub CopyRanges_BetweenShts()

    
    Dim wbSrc                           As Workbook
    Dim wbDest                          As Workbook
    Dim shtCopy                         As Worksheet
    Dim shtPaste                        As Worksheet
    
    ' set reference to all workbooks by name, don't rely on ActiveWorkbook
    Set wbSrc = Workbooks(&quot;Data.xlsx&quot;)
    Set wbDest = Workbooks(&quot;Results.xlsx&quot;)
    
    ' set reference to all sheets by name, don't rely on ActiveSheet
    Set shtCopy = wbSrc.Sheet1 '// &quot;Raw_Data&quot; sheet
    Set shtPaste = wbDest.Sheet2 '// &quot;Refined_Data&quot;) sheet
    
    ' copy range from &quot;Data&quot; workbook to &quot;Results&quot; workbook without using Select
    shtCopy.Range(&quot;A1:C10&quot;).Copy _
    Destination:=shtPaste.Range(&quot;A1&quot;)

End Sub
</code></pre>
<h2 id="use-nomeação-de-variável-descritiva">Use nomeação de variável descritiva <a href="#use-nomea%c3%a7%c3%a3o-de-vari%c3%a1vel-descritiva" class="anchor" aria-hidden="true">#</a></h2>
<p>Nomes descritivos e estrutura em seu código ajudam a tornar os comentários desnecessários</p>
<pre><code>Dim ductWidth  As Double
Dim ductHeight As Double
Dim ductArea   As Double

ductArea = ductWidth * ductHeight
</code></pre>
<p>é melhor que</p>
<pre><code>Dim a, w, h

a = w * h
</code></pre>
<p>Isso é especialmente útil quando você está copiando dados de um lugar para outro, seja uma célula, intervalo, planilha ou pasta de trabalho. Sirva-se usando nomes como estes:</p>
<pre><code>Dim myWB As Workbook
Dim srcWS As Worksheet
Dim destWS As Worksheet
Dim srcData As Range
Dim destData As Range

Set myWB = ActiveWorkbook
Set srcWS = myWB.Sheets(&quot;Sheet1&quot;)
Set destWS = myWB.Sheets(&quot;Sheet2&quot;)
Set srcData = srcWS.Range(&quot;A1:A10&quot;)
Set destData = destWS.Range(&quot;B11:B20&quot;)
destData = srcData
</code></pre>
<p>Se você declarar várias variáveis ​​em uma linha, certifique-se de especificar um tipo para <em>cada</em> variável como:</p>
<pre><code>Dim ductWidth As Double, ductHeight As Double, ductArea As Double
</code></pre>
<p>O seguinte só declarará a última variável e as primeiras permanecerão como <code>Variant</code>:</p>
<pre><code>Dim ductWidth, ductHeight, ductArea As Double
</code></pre>
<h2 id="documente-seu-trabalho">Documente seu trabalho <a href="#documente-seu-trabalho" class="anchor" aria-hidden="true">#</a></h2>
<p>É uma boa prática documentar seu trabalho para uso posterior, especialmente se você estiver codificando para uma carga de trabalho dinâmica. Bons comentários devem explicar por que o código está fazendo algo, não o que o código está fazendo.</p>
<pre><code>Function Bonus(EmployeeTitle as String) as Double
    If EmployeeTitle = &quot;Sales&quot; Then
        Bonus = 0    'Sales representatives receive commission instead of a bonus
    Else
        Bonus = .10
    End If
End Function
</code></pre>
<p>Se o seu código for tão obscuro que exija comentários para explicar o que está fazendo, considere reescrevê-lo para ficar mais claro em vez de explicá-lo por meio de comentários. Por exemplo, em vez de:</p>
<pre><code>Sub CopySalesNumbers
    Dim IncludeWeekends as Boolean
    
    'Boolean values can be evaluated as an integer, -1 for True, 0 for False.
    'This is used here to adjust the range from 5 to 7 rows if including weekends.
    Range(&quot;A1:A&quot; &amp; 5 - (IncludeWeekends * 2)).Copy
    Range(&quot;B1&quot;).PasteSpecial
End Sub
</code></pre>
<p>Esclareça o código para ser mais fácil de seguir, como:</p>
<pre><code>Sub CopySalesNumbers
    Dim IncludeWeekends as Boolean
    Dim DaysinWeek as Integer
    
    If IncludeWeekends Then
        DaysinWeek = 7
    Else
        DaysinWeek = 5
    End If
    Range(&quot;A1:A&quot; &amp; DaysinWeek).Copy
    Range(&quot;B1&quot;).PasteSpecial
End Sub 
</code></pre>
<h2 id="manipulação-de-erros">Manipulação de erros <a href="#manipula%c3%a7%c3%a3o-de-erros" class="anchor" aria-hidden="true">#</a></h2>
<p>Um bom tratamento de erros evita que os usuários finais vejam erros de tempo de execução do VBA e ajuda o desenvolvedor a diagnosticar e corrigir erros facilmente.</p>
<p>Existem três métodos principais de tratamento de erros no VBA, dois dos quais devem ser evitados para programas distribuídos, a menos que seja especificamente exigido no código.</p>
<pre><code>On Error GoTo 0 'Avoid using
</code></pre>
<p>ou</p>
<pre><code>On Error Resume Next 'Avoid using
</code></pre>
<p>Prefira usar:</p>
<pre><code>On Error GoTo &lt;line&gt; 'Prefer using
</code></pre>
<hr>
<h1 id="on-error-goto-0">On Error GoTo 0 <a href="#on-error-goto-0" class="anchor" aria-hidden="true">#</a></h1>
<p>Se nenhum tratamento de erro for definido em seu código, <code>On Error GoTo 0</code> será o manipulador de erro padrão. Nesse modo, qualquer erro de tempo de execução iniciará a mensagem de erro típica do VBA, permitindo que você termine o código ou entre no modo <code>debug</code>, identificando a fonte. Ao escrever código, esse método é o mais simples e útil, mas deve ser sempre evitado para código distribuído aos usuários finais, pois esse método é muito feio e difícil de entender para os usuários finais.</p>
<hr>
<h1 id="on-error-resume-next">On Error Resume Next <a href="#on-error-resume-next" class="anchor" aria-hidden="true">#</a></h1>
<p><code>On Error Resume Next</code> fará com que o VBA ignore quaisquer erros que são lançados em tempo de execução para todas as linhas após a chamada de erro até que o manipulador de erros seja alterado. Em casos muito específicos, essa linha pode ser útil, mas deve ser evitada fora desses casos. Por exemplo, ao iniciar um programa separado de uma Macro do Excel, a chamada <code>On Error Resume Next</code> pode ser útil se você não tiver certeza se o programa já está aberto ou não:</p>
<pre><code>'In this example, we open an instance of Powerpoint using the On Error Resume Next call
Dim PPApp As PowerPoint.Application
Dim PPPres As PowerPoint.Presentation
Dim PPSlide As PowerPoint.Slide

'Open PPT if not running, otherwise select active instance
On Error Resume Next
Set PPApp = GetObject(, &quot;PowerPoint.Application&quot;)
On Error GoTo ErrHandler
If PPApp Is Nothing Then
    'Open PowerPoint
    Set PPApp = CreateObject(&quot;PowerPoint.Application&quot;)
    PPApp.Visible = True
End If
</code></pre>
<p>Se não tivéssemos usado a chamada <code>On Error Resume Next</code> e o aplicativo Powerpoint ainda não estivesse aberto, o método <code>GetObject</code> geraria um erro. Assim, <code>On Error Resume Next</code> foi necessário para evitar a criação de duas instâncias da aplicação.</p>
<p><strong>Observação:</strong> também é uma prática recomendada redefinir <em>imediatamente</em> o manipulador de erros assim que você não precisar mais da chamada <code>On Error Resume Next</code></p>
<hr>
<h1 id="on-error-goto-line">On Error GoTo &lt;line&gt; <a href="#on-error-goto-line" class="anchor" aria-hidden="true">#</a></h1>
<p>Esse método de tratamento de erros é recomendado para todo código distribuído a outros usuários. Isso permite que o programador controle exatamente como o VBA trata um erro enviando o código para a linha especificada. A tag <line> pode ser preenchida com qualquer string (incluindo strings numéricas) e enviará o código para a string correspondente seguida por dois pontos. Vários blocos de tratamento de erros podem ser usados ​​fazendo diferentes chamadas de <code>On Error GoTo &lt;line&gt;</code>. A sub-rotina abaixo demonstra a sintaxe de uma chamada <code>On Error GoTo &lt;line&gt;</code>.</p>
<p><strong>Nota:</strong> É essencial que a linha <code>Exit Sub</code> seja colocada acima do primeiro manipulador de erro e antes de cada manipulador de erro subsequente para evitar que o código progrida naturalmente no bloco <em>sem</em> que um erro seja chamado. Assim, é uma prática recomendada para função e legibilidade colocar manipuladores de erro no final de um bloco de código.</p>
<pre><code>Sub YourMethodName()
    On Error GoTo errorHandler
    ' Insert code here
    On Error GoTo secondErrorHandler

    Exit Sub 'The exit sub line is essential, as the code will otherwise
             'continue running into the error handling block, likely causing an error

errorHandler:
    MsgBox &quot;Error &quot; &amp; Err.Number &amp; &quot;: &quot; &amp; Err.Description &amp; &quot; in &quot; &amp; _
        VBE.ActiveCodePane.CodeModule, vbOKOnly, &quot;Error&quot;
    Exit Sub

secondErrorHandler:
    If Err.Number = 424 Then 'Object not found error (purely for illustration)
        Application.ScreenUpdating = True
        Application.EnableEvents = True
        Exit Sub
    Else
        MsgBox &quot;Error &quot; &amp; Err.Number &amp; &quot;: &quot; &amp; Err.Desctription
        Application.ScreenUpdating = True
        Application.EnableEvents = True   
        Exit Sub
    End If      
    Exit Sub

End Sub
</code></pre>
<p>Se você sair do método com o código de tratamento de erros, certifique-se de limpar:</p>
<ul>
<li>Desfazer qualquer coisa que esteja parcialmente concluída</li>
<li>Fechar arquivos</li>
<li>Redefinir a atualização da tela</li>
<li>Redefinir o modo de cálculo</li>
<li>Redefinir eventos</li>
<li>Redefinir ponteiro do mouse</li>
<li>Chama o método unload em instâncias de objetos, que persistem após o <code>End Sub</code></li>
<li>Redefinir barra de status</li>
</ul>
<h2 id="nunca-assuma-a-planilha">Nunca Assuma A Planilha <a href="#nunca-assuma-a-planilha" class="anchor" aria-hidden="true">#</a></h2>
<p>Mesmo quando todo o seu trabalho é direcionado a uma única planilha, ainda é uma prática muito boa especificar explicitamente a planilha em seu código. Esse hábito torna muito mais fácil expandir seu código mais tarde, ou levantar partes (ou todos) de um <code>Sub</code> ou <code>Function</code> para serem reutilizados em outro lugar. Muitos desenvolvedores estabelecem o hábito de (re)usar o mesmo nome de variável local para uma planilha em seu código, tornando a reutilização desse código ainda mais simples.</p>
<p>Como exemplo, o código a seguir é ambíguo &ndash; mas funciona! &ndash; desde que o desenvolvedor não ative ou mude para uma planilha diferente:</p>
<pre><code>Option Explicit
Sub ShowTheTime()
    '--- displays the current time and date in cell A1 on the worksheet
    Cells(1, 1).Value = Now()  ' don't refer to Cells without a sheet reference!
End Sub
</code></pre>
<p>Se a &lsquo;Planilha1&rsquo; estiver ativa, a célula A1 da Planilha1 será preenchida com a data e hora atuais. Mas se o usuário alterar as planilhas por qualquer motivo, o código atualizará qualquer planilha que esteja ativa no momento. A planilha de destino é ambígua.</p>
<p>A melhor prática é sempre identificar a qual planilha seu código se refere:</p>
<pre><code>Option Explicit
Sub ShowTheTime()
    '--- displays the current time and date in cell A1 on the worksheet
    Dim myWB As Workbook
    Set myWB = ThisWorkbook
    Dim timestampSH As Worksheet
    Set timestampSH = myWB.Sheets(&quot;Sheet1&quot;)
    timestampSH.Cells(1, 1).Value = Now()
End Sub
</code></pre>
<p>O código acima é claro na identificação da pasta de trabalho e da planilha. Embora possa parecer um exagero, criar um bom hábito em relação às referências de destino o salvará de problemas futuros.</p>
<h2 id="evite-usar-activecell-ou-activesheet-no-excel">Evite usar ActiveCell ou ActiveSheet no Excel <a href="#evite-usar-activecell-ou-activesheet-no-excel" class="anchor" aria-hidden="true">#</a></h2>
<p>Usar <code>ActiveCell</code> ou <code>ActiveSheet</code> pode ser fonte de erros se (por qualquer motivo) o código for executado no lugar errado.</p>
<pre><code>ActiveCell.Value = &quot;Hello&quot; 
'will place &quot;Hello&quot; in the cell that is currently selected
Cells(1, 1).Value = &quot;Hello&quot; 
'will always place &quot;Hello&quot; in A1 of the currently selected sheet

ActiveSheet.Cells(1, 1).Value = &quot;Hello&quot; 
'will place &quot;Hello&quot; in A1 of the currently selected sheet
Sheets(&quot;MySheetName&quot;).Cells(1, 1).Value = &quot;Hello&quot; 
'will always place &quot;Hello&quot; in A1 of the sheet named &quot;MySheetName&quot;
</code></pre>
<ul>
<li>O uso de <code>Active*</code> pode criar problemas em macros de longa execução se o usuário ficar entediado e clicar em outra planilha ou abrir outra pasta de trabalho.</li>
<li>Pode criar problemas se seu código abrir ou criar outra pasta de trabalho.</li>
<li>Pode criar problemas se seu código usar <code>Sheets(&quot;MyOtherSheet&quot;).Select</code> e você esquecer em qual planilha estava antes de começar a ler ou escrever nela.</li>
</ul>
<h2 id="o-objeto-worksheetfunction-é-executado-mais-rápido-que-um-equivalente-udf">O objeto WorksheetFunction é executado mais rápido que um equivalente UDF <a href="#o-objeto-worksheetfunction-%c3%a9-executado-mais-r%c3%a1pido-que-um-equivalente-udf" class="anchor" aria-hidden="true">#</a></h2>
<p>O VBA é compilado em tempo de execução, o que tem um enorme impacto negativo em seu desempenho, tudo embutido será mais rápido, tente usá-los.</p>
<p>Como exemplo, estou comparando as funções SUM e COUNTIF, mas você pode usar if para qualquer coisa que possa resolver com WorkSheetFunctions.</p>
<p>Uma primeira tentativa para isso seria percorrer o intervalo e processá-lo célula por célula (usando um intervalo):</p>
<pre><code>Sub UseRange()
    Dim rng as Range
    Dim Total As Double
    Dim CountLessThan01 As Long
    
    Total = 0
    CountLessThan01 = 0
    For Each rng in Sheets(1).Range(&quot;A1:A100&quot;)
        Total = Total + rng.Value2
        If rng.Value &lt; 0.1 Then
            CountLessThan01 = CountLessThan01 + 1
        End If
    Next rng
    Debug.Print Total &amp; &quot;, &quot; &amp; CountLessThan01
End Sub
</code></pre>
<p>Uma melhoria pode ser armazenar os valores de intervalo em uma matriz e processar que:</p>
<pre><code>Sub UseArray()
    Dim DataToSummarize As Variant
    Dim i As Long
    Dim Total As Double
    Dim CountLessThan01 As Long
    
    DataToSummarize = Sheets(1).Range(&quot;A1:A100&quot;).Value2 'faster than .Value
    Total = 0
    CountLessThan01 = 0
    For i = 1 To 100
        Total = Total + DataToSummarize(i, 1)
        If DataToSummarize(i, 1) &lt; 0.1 Then
            CountLessThan01 = CountLessThan01 + 1
        End If
    Next i
    Debug.Print Total &amp; &quot;, &quot; &amp; CountLessThan01
End Sub
</code></pre>
<p>Mas ao invés de escrever qualquer loop você pode usar <code>Application.Worksheetfunction</code> que é muito útil para executar fórmulas simples:</p>
<pre><code>Sub UseWorksheetFunction()
    Dim Total As Double
    Dim CountLessThan01 As Long
    
    With Application.WorksheetFunction
        Total = .Sum(Sheets(1).Range(&quot;A1:A100&quot;))
        CountLessThan01 = .CountIf(Sheets(1).Range(&quot;A1:A100&quot;), &quot;&lt;0.1&quot;)
    End With
    
    Debug.Print Total &amp; &quot;, &quot; &amp; CountLessThan01
End Sub
</code></pre>
<p>Ou, para cálculos mais complexos, você pode até usar <code>Application.Evaluate</code>:</p>
<pre><code>Sub UseEvaluate()
    Dim Total As Double
    Dim CountLessThan01 As Long
    
    With Application
        Total = .Evaluate(&quot;SUM(&quot; &amp; Sheet1.Range(&quot;A1:A100&quot;).Address( _
            external:=True) &amp; &quot;)&quot;)
        CountLessThan01 = .Evaluate(&quot;COUNTIF('Sheet1'!A1:A100,&quot;&quot;&lt;0.1&quot;&quot;)&quot;)
    End With
    
    Debug.Print Total &amp; &quot;, &quot; &amp; CountLessThan01
End Sub
</code></pre>
<p>E, finalmente, rodando acima de Subs 25.000 vezes cada, aqui está o tempo médio (5 testes) em milissegundos (é claro que será diferente em cada PC, mas comparados entre si eles se comportarão de maneira semelhante):</p>
<ol>
<li>UseWorksheetFunction: 2156 ms</li>
<li>UseArray: 2219 ms (+ 3%)</li>
<li>UseAvaliar: 4693 ms (+ 118%)</li>
<li>Faixa de uso: 6530 ms (+ 203%)</li>
</ol>
<h2 id="evite-redefinir-os-nomes-de-propriedades-ou-métodos-como-suas-variáveis">Evite redefinir os nomes de Propriedades ou Métodos como suas variáveis <a href="#evite-redefinir-os-nomes-de-propriedades-ou-m%c3%a9todos-como-suas-vari%c3%a1veis" class="anchor" aria-hidden="true">#</a></h2>
<p>Geralmente não é considerado &lsquo;melhor prática&rsquo; redefinir os nomes reservados de Propriedades ou Métodos como o(s) nome(s) de seus próprios procedimentos e variáveis.</p>
<p><strong>Formulário incorreto</strong> - Embora o seguinte seja (estritamente falando) legal, o código de trabalho é o redirecionamento do <a href="https://msdn.microsoft.com/en-us/library/office/ff839746.aspx">Localizar</a>, bem como o método <a href="https://msdn.microsoft.com/en-us/library/office/ff196952.aspx">Row</a>, [Column](https://msdn.microsoft.com/en-us As propriedades /library/office/ff198200.aspx) e <a href="https://msdn.microsoft.com/en-us/library/office/ff837625.aspx">Address</a> podem causar problemas/conflitos com ambiguidade de nome e é simplesmente confuso no geral.</p>
<pre><code>Option Explicit

Sub find()
    Dim row As Long, column As Long
    Dim find As String, address As Range
    
    find = &quot;something&quot;
    
    With ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Cells
        Set address = .SpecialCells(xlCellTypeLastCell)
        row = .find(what:=find, after:=address).row        '&lt; note .row not capitalized
        column = .find(what:=find, after:=address).column  '&lt; note .column not capitalized
        
        Debug.Print &quot;The first 'something' is in &quot; &amp; .Cells(row, column).address(0, 0)
    End With
End Sub
</code></pre>
<p><strong>Boa forma</strong> - Com todas as palavras reservadas renomeadas em aproximações próximas, mas exclusivas, dos originais, qualquer conflito de nomenclatura em potencial foi evitado.</p>
<pre><code>Option Explicit

Sub myFind()
    Dim rw As Long, col As Long
    Dim wht As String, lastCell As Range
    
    wht = &quot;something&quot;
    
    With ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Cells
        Set lastCell = .SpecialCells(xlCellTypeLastCell)
        rw = .Find(What:=wht, After:=lastCell).Row         '◄ note .Find and .Row
        col = .Find(What:=wht, After:=lastCell).Column     '◄ .Find and .Column
        
        Debug.Print &quot;The first 'something' is in &quot; &amp; .Cells(rw, col).Address(0, 0)
    End With
End Sub
</code></pre>
<p>Embora possa chegar um momento em que você queira reescrever intencionalmente um método ou propriedade padrão de acordo com suas próprias especificações, essas situações são poucas e distantes entre si. Na maioria das vezes, evite reutilizar nomes reservados para suas próprias construções.</p>
<hr>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				</div>
			<div class="docs-navigation d-flex justify-content-between">
	
	
		<a href="/pt/excel-vba/introducao-ao-excel-vba/">
						<div class="card my-1">
							<div class="card-body py-2">
								&larr; Introdução ao excel-vba
							</div>
						</div>
					</a>
				<a class="ms-auto" href="/pt/excel-vba/metodos-para-encontrar-a-ultima-linha-ou-coluna-usada-em-uma-planilha/">
						<div class="card my-1">
							<div class="card-body py-2">
								Métodos para encontrar a última linha ou coluna usada em uma planilha &rarr;
							</div>
						</div>
					</a>
				
	
	</div>

			
		</main>
	</div>

      </div>
    </div>
    
    
    <footer class="footer text-muted">
  <div class="container-xxl">
    <div class="row">
      <div class="col-lg-8 order-last order-lg-first">
        <ul class="list-inline">
          <li class="list-inline-item">Copyright © 2018-2022 Wikiod.</li>
        </ul>
      </div>
      <div class="col-lg-8 order-first order-lg-last text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item"><a href="/pt/about/">cerca de</a></li>
          <li class="list-inline-item"><a href="/pt/disclaimers/">Isenções de responsabilidade</a></li>
          <li class="list-inline-item"><a href="/pt/dcma/">DCMA</a></li>
          <li class="list-inline-item"><a href="/pt/terms-of-use/">Termos de uso</a></li>
          <li class="list-inline-item"><a href="/pt/privacy-policy/">Política de Privacidade</a></li>
          </ul>
      </div>
    </div>
  </div>
</footer>
    

<script src="/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js" integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51&#43;L6gymJi4Qg==" crossorigin="anonymous" defer></script>
  <script src="/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js" integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin="anonymous" defer></script>
  <script src="/main.min.4971645518aa07968852c38e2c8051abe697181395ad03d5fa0eb28e42edf5f54f801de05c98298ce77b65223caf97b7ea259fbca096e64b3840985ec069e2ef.js" integrity="sha512-SXFkVRiqB5aIUsOOLIBRq&#43;aXGBOVrQPV&#43;g6yjkLt9fVPgB3gXJgpjOd7ZSI8r5e36iWfvKCW5ks4QJhewGni7w==" crossorigin="anonymous" defer></script>
  
    
  </body>
</html>