<!doctype html>
<html lang="pt">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-500.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-700.woff2" type="font/woff2" crossorigin>

  <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>

  <link rel="stylesheet" href="https://www.wikiod.com/main.7636753edc6f50e96b0045eba39982b1b0b2b6947250d1080bec1f4cbe52399ea6bcecac0e0b6026886b51bdbde879ec9a9820765b03caead79d8ddf3b79336f.css" integrity="sha512-djZ1PtxvUOlrAEXro5mCsbCytpRyUNEIC&#43;wfTL5SOZ6mvOysDgtgJohrUb296HnsmpggdlsDyurXnY3fO3kzbw==" crossorigin="anonymous">
<noscript><style>img.lazyload { display: none; }</style></noscript>
  <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <title>Otimização Excel-VBA - WikiOD</title>
<meta name="description" content="Otimização Excel-VBA também se refere à codificação melhor tratamento de erros por documentação e detalhes adicionais. Isso é mostrado aqui.
*) Os números de linha representados são inteiros, ou seja, um tipo de dados de 16 bits com sinal no intervalo de -32.768 a 32.767, caso contrário, você produzirá um estouro. Normalmente os números de linha são inseridos em passos de 10 sobre uma parte do código ou todos os procedimentos de um módulo como um todo.">
  <link rel="canonical" href="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">
<meta property="og:locale" content="pt">
<meta property="og:type" content="article">
<meta property="og:title" content="Otimização Excel-VBA">
<meta property="og:description" content="Otimização Excel-VBA também se refere à codificação melhor tratamento de erros por documentação e detalhes adicionais. Isso é mostrado aqui.
*) Os números de linha representados são inteiros, ou seja, um tipo de dados de 16 bits com sinal no intervalo de -32.768 a 32.767, caso contrário, você produzirá um estouro. Normalmente os números de linha são inseridos em passos de 10 sobre uma parte do código ou todos os procedimentos de um módulo como um todo.">
<meta property="og:url" content="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">
<meta property="og:site_name" content="WikiOD">

  <meta property="og:image" content="https://www.wikiod.com/wikiod_logo.png"/>
      <meta property="og:image:alt" content="WikiOD">
    
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@wikiod">
<meta name="twitter:creator" content="@wikiod">
<meta name="twitter:title" content="Otimização Excel-VBA">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://www.wikiod.com/wikiod_logo.png">
    <meta name="twitter:image:alt" content="Otimização Excel-VBA">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
        "@id": "https://www.wikiod.com/#/schema/organization/1",
      "name": "WikiOD",
      "url": "https://www.wikiod.com/",
      "sameAs": [
        "https://twitter.com/wikiod"
        , "https://github.com/wikiod-com"
        ],
      "logo": {
          "@type": "ImageObject",
          "@id": "https://www.wikiod.com/#/schema/image/1",
          "url": "https://www.wikiod.com/wikiod_logo.png",
          "width":  512 ,
          "height":  512 ,
          "caption": "WikiOD"
        },
        "image": {
          "@id": "https://www.wikiod.com/#/schema/image/1"
        }
      },
    {
      "@type": "WebSite",
      "@id": "https://www.wikiod.com/#/schema/website/1",
      "url": "https://www.wikiod.com/",
      "name": "WikiOD",
      "description": "Bem-vindo ao WikiOD - Documentação online do Wiki O WikiOD é um projeto de escrita colaborativa para construir documentação online da mais alta qualidade de todas as linguagens de programação, assuntos e conceitos relacionados à educação.",
      "publisher": {
          "@id": "https://www.wikiod.com/#/schema/organization/1"
        }
      },
    {
      "@type": "WebPage",
      "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/",
      "url": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/",
      "name": "Otimização Excel-VBA",
      "description": "",
      "isPartOf": {
        "@id": "https://www.wikiod.com/#/schema/website/1"
      },
      "about": {
          "@id": "https://www.wikiod.com/#/schema/organization/1"
        },
      "datePublished": "0001-01-01T00:00:00CET",
      "dateModified": "0001-01-01T00:00:00CET",
      "breadcrumb": {
        "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/#/schema/breadcrumb/1"
      },
      "primaryImageOfPage": {
        "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/#/schema/image/2"
      },
      "inLanguage": "pt",
      "potentialAction": [{
        "@type": "ReadAction", "target": ["https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/"]
      }]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/#/schema/breadcrumb/1",
      "name": "Breadcrumbs",
      "itemListElement": [{
        "@type": "ListItem",
        "position":  1 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/",
          "url": "https://www.wikiod.com/",
          "name": "Home"
          }
        },{
        "@type": "ListItem",
        "position":  2 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/pt/",
          "url": "https://www.wikiod.com/pt/",
          "name": "Pt"
          }
        },{
        "@type": "ListItem",
        "position":  3 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/pt/excel-vba/",
          "url": "https://www.wikiod.com/pt/excel-vba/",
          "name": "Excel Vba"
          }
        },{
        "@type": "ListItem",
        "position":  4 ,
        "item": {
          "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/"
          }
        }]
    },

    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Article",
          "@id": "https://www.wikiod.com/#/schema/article/1",
          "headline": "Otimização Excel-VBA",
          "description": "",
          "isPartOf": {
            "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/"
          },
          "mainEntityOfPage": {
            "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/"
          },
          "datePublished": "0001-01-01T00:00:00CET",
          "dateModified": "0001-01-01T00:00:00CET",
          "author": {
            "@id": "https://www.wikiod.com/#/schema/person/2"
          },
          "publisher": {
              "@id": "https://www.wikiod.com/#/schema/organization/1"
            },
          "image": {
            "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/#/schema/image/2"
          }
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Person",
          "@id": "https://www.wikiod.com/#/schema/person/2",
          "name": "WikiOD",
          "sameAs": [
            "https://twitter.com/wikiod"
            , "https://github.com/wikiod-com"
            ]
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "ImageObject",
          "@id": "https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/#/schema/image/2",
          "url": "https://www.wikiod.com/wikiod_logo.png",
          "contentUrl": "https://www.wikiod.com/wikiod_logo.png",
          "caption": "Otimização Excel-VBA"
        }
      ]
    }

  ]
}
</script>

  <meta name="theme-color" content="#fff">
<link rel="icon" href="https://www.wikiod.com/favicon.ico" sizes="any">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.wikiod.com/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.wikiod.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.wikiod.com/favicon-16x16.png">
<link rel="manifest" crossorigin="use-credentials" href="https://www.wikiod.com/site.webmanifest">

  
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9345677191971886" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y7ZZF8Q2L4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y7ZZF8Q2L4');
</script>

</head>

  <body class="docs single">
    <div class="sticky-top">
<div class="header-bar"></div>

<header class="navbar navbar-expand-lg navbar-light doks-navbar">
  <nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation">

    <a class="navbar-brand order-0" href="/pt/" aria-label="WikiOD">
      WikiOD
    </a>

    <button class="btn btn-link order-0 ms-auto d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
    </button>
    <div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
      <div class="header-bar"></div>
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">Navegar docs</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <aside class="doks-sidebar mt-n3">
          <nav id="doks-docs-nav" aria-label="Tertiary navigation">
            

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/pt/docs/excel-vba/"><h3 class="h6 text-uppercase mb-2">tutorial excel-vba</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/introducao-ao-excel-vba/">Introdução ao excel-vba</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">Práticas recomendadas de VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/metodos-para-encontrar-a-ultima-linha-ou-coluna-usada-em-uma-planilha/">Métodos para encontrar a última linha ou coluna usada em uma planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/dicas-e-truques-do-excel-vba/">Dicas e truques do Excel VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/erros-comuns/">Erros comuns</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-e-celulas/">Intervalos e Células</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/depuracao-e-solucao-de-problemas/">Depuração e solução de problemas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/matrizes/">Matrizes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/percorra-todas-as-planilhas-na-pasta-de-trabalho-ativa/">Percorra todas as planilhas na pasta de trabalho ativa</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/funcoes-definidas-pelo-usuario-udfs/">Funções definidas pelo usuário (UDFs)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/tabelas-dinamicas/">Tabelas dinâmicas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/formatacao-condicional-usando-vba/">Formatação condicional usando VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">Otimização Excel-VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/integracao-do-powerpoint-atraves-do-vba/">Integração do PowerPoint através do VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/filtro-automatico-usos-e-boas-praticas/">filtro automático; Usos e boas práticas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/sql-no-excel-vba---praticas-recomendadas/">SQL no Excel VBA - Práticas recomendadas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/vinculativo/">Vinculativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/pastas-de-trabalho/">Pastas de trabalho</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/graficos-e-graficos/">Gráficos e gráficos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/criando-um-menu-suspenso-na-planilha-ativa-com-uma-caixa-de-combinacao/">Criando um menu suspenso na planilha ativa com uma caixa de combinação</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-do-sistema-de-arquivos/">Objeto do sistema de arquivos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/trabalhando-com-tabelas-do-excel-em-vba/">Trabalhando com tabelas do Excel em VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/localizando-valores-duplicados-em-um-intervalo/">Localizando valores duplicados em um intervalo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-nomeados/">Intervalos nomeados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/como-gravar-uma-macro/">Como gravar uma macro</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-de-aplicativo/">Objeto de aplicativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/seguranca-vba/">Segurança VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/celulasintervalos-mesclados/">Célulasintervalos mesclados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/declaracoes-condicionais/">Declarações condicionais</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/use-o-objeto-planilha-e-nao-o-objeto-planilha/">Use o objeto Planilha e não o objeto Planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/customdocumentproperties-na-pratica/">CustomDocumentProperties na prática</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


          </nav>
        </aside>
      </div>
    </div>
    <button class="btn btn-menu order-2 d-block d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDoks" aria-controls="offcanvasDoks" aria-label="Open main menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>
    <div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex="-1" id="offcanvasDoks" data-bs-backdrop="true" aria-labelledby="offcanvasDoksLabel">
      <div class="header-bar d-lg-none"></div>
      <div class="offcanvas-header d-lg-none">
        <h2 class="h5 offcanvas-title ps-2" id="offcanvasDoksLabel"><a class="text-dark" href="/pt/">WikiOD</a></h2>
        <button type="button" class="btn-close text-reset me-2" data-bs-dismiss="offcanvas" aria-label="Close main menu"></button>
      </div>
      <div class="offcanvas-body p-4 p-lg-0">
        <ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto">
              <li class="nav-item">
                <a class="nav-link ps-0 py-1" href="/pt/docs/">Tutoriais</a>
              </li>
            
          
              <li class="nav-item">
                <a class="nav-link ps-0 py-1" href="/pt/blog/">Artigos</a>
              </li>
            
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <ul class="nav flex-column flex-lg-row">
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <button id="mode" class="btn btn-link" type="button" aria-label="Toggle user interface mode">
          <span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
          <span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
        </button>
        <hr class="text-black-50 my-4 d-lg-none">
        <div class="dropdown">
          <button class="btn btn-doks-light dropdown-toggle" id="doks-languages" data-bs-toggle="dropdown" aria-expanded="false" data-bs-display="static">
            Português
            <span class="dropdown-caret"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby="doks-languages">

            <li><a class="dropdown-item current" aria-current="true" href="/pt/excel-vba/otimizacao-excel-vba/">Português</a></li>

            <li><hr class="dropdown-divider"></li>

            
                <li><a class="dropdown-item" rel="alternate" href="/excel-vba/excel-vba-optimization/" hreflang="en" lang="en">English</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/es/excel-vba/optimizacion-excel-vba/" hreflang="es" lang="es">Español</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/fr/excel-vba/optimisation-excel-vba/" hreflang="fr" lang="fr">Français</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/tr/excel-vba/excel-vba-optimizasyonu/" hreflang="tr" lang="tr">Türk</a></li>
              
          </ul>
        </div>
        </div>
    </div>
  </nav>
</header>


</div>
<div class="container-xxl">
  <aside class="doks-sidebar">
    <nav id="doks-docs-nav" class="collapse d-lg-none" aria-label="Tertiary navigation">
      

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/pt/docs/excel-vba/"><h3 class="h6 text-uppercase mb-2">tutorial excel-vba</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/introducao-ao-excel-vba/">Introdução ao excel-vba</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">Práticas recomendadas de VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/metodos-para-encontrar-a-ultima-linha-ou-coluna-usada-em-uma-planilha/">Métodos para encontrar a última linha ou coluna usada em uma planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/dicas-e-truques-do-excel-vba/">Dicas e truques do Excel VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/erros-comuns/">Erros comuns</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-e-celulas/">Intervalos e Células</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/depuracao-e-solucao-de-problemas/">Depuração e solução de problemas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/matrizes/">Matrizes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/percorra-todas-as-planilhas-na-pasta-de-trabalho-ativa/">Percorra todas as planilhas na pasta de trabalho ativa</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/funcoes-definidas-pelo-usuario-udfs/">Funções definidas pelo usuário (UDFs)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/tabelas-dinamicas/">Tabelas dinâmicas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/formatacao-condicional-usando-vba/">Formatação condicional usando VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">Otimização Excel-VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/integracao-do-powerpoint-atraves-do-vba/">Integração do PowerPoint através do VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/filtro-automatico-usos-e-boas-praticas/">filtro automático; Usos e boas práticas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/sql-no-excel-vba---praticas-recomendadas/">SQL no Excel VBA - Práticas recomendadas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/vinculativo/">Vinculativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/pastas-de-trabalho/">Pastas de trabalho</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/graficos-e-graficos/">Gráficos e gráficos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/criando-um-menu-suspenso-na-planilha-ativa-com-uma-caixa-de-combinacao/">Criando um menu suspenso na planilha ativa com uma caixa de combinação</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-do-sistema-de-arquivos/">Objeto do sistema de arquivos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/trabalhando-com-tabelas-do-excel-em-vba/">Trabalhando com tabelas do Excel em VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/localizando-valores-duplicados-em-um-intervalo/">Localizando valores duplicados em um intervalo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-nomeados/">Intervalos nomeados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/como-gravar-uma-macro/">Como gravar uma macro</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-de-aplicativo/">Objeto de aplicativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/seguranca-vba/">Segurança VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/celulasintervalos-mesclados/">Célulasintervalos mesclados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/declaracoes-condicionais/">Declarações condicionais</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/use-o-objeto-planilha-e-nao-o-objeto-planilha/">Use o objeto Planilha e não o objeto Planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/customdocumentproperties-na-pratica/">CustomDocumentProperties na prática</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


    </nav>
  </aside>
</div>


    <div class="wrap container-xxl" role="document">
      <div class="content">
        
	<div class="row flex-xl-nowrap">
		<div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block">
			<nav id="sidebar-default" class="docs-links" aria-label="Main navigation">
				

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/pt/docs/excel-vba/"><h3 class="h6 text-uppercase mb-2">tutorial excel-vba</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/introducao-ao-excel-vba/">Introdução ao excel-vba</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/praticas-recomendadas-de-vba/">Práticas recomendadas de VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/metodos-para-encontrar-a-ultima-linha-ou-coluna-usada-em-uma-planilha/">Métodos para encontrar a última linha ou coluna usada em uma planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/dicas-e-truques-do-excel-vba/">Dicas e truques do Excel VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/erros-comuns/">Erros comuns</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-e-celulas/">Intervalos e Células</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/depuracao-e-solucao-de-problemas/">Depuração e solução de problemas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/matrizes/">Matrizes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/percorra-todas-as-planilhas-na-pasta-de-trabalho-ativa/">Percorra todas as planilhas na pasta de trabalho ativa</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/funcoes-definidas-pelo-usuario-udfs/">Funções definidas pelo usuário (UDFs)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/tabelas-dinamicas/">Tabelas dinâmicas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/formatacao-condicional-usando-vba/">Formatação condicional usando VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/pt/excel-vba/otimizacao-excel-vba/">Otimização Excel-VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/integracao-do-powerpoint-atraves-do-vba/">Integração do PowerPoint através do VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/filtro-automatico-usos-e-boas-praticas/">filtro automático; Usos e boas práticas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/sql-no-excel-vba---praticas-recomendadas/">SQL no Excel VBA - Práticas recomendadas</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/vinculativo/">Vinculativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/pastas-de-trabalho/">Pastas de trabalho</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/graficos-e-graficos/">Gráficos e gráficos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/criando-um-menu-suspenso-na-planilha-ativa-com-uma-caixa-de-combinacao/">Criando um menu suspenso na planilha ativa com uma caixa de combinação</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-do-sistema-de-arquivos/">Objeto do sistema de arquivos</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/trabalhando-com-tabelas-do-excel-em-vba/">Trabalhando com tabelas do Excel em VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/localizando-valores-duplicados-em-um-intervalo/">Localizando valores duplicados em um intervalo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/intervalos-nomeados/">Intervalos nomeados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/como-gravar-uma-macro/">Como gravar uma macro</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/objeto-de-aplicativo/">Objeto de aplicativo</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/seguranca-vba/">Segurança VBA</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/celulasintervalos-mesclados/">Célulasintervalos mesclados</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/declaracoes-condicionais/">Declarações condicionais</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/use-o-objeto-planilha-e-nao-o-objeto-planilha/">Use o objeto Planilha e não o objeto Planilha</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/pt/excel-vba/customdocumentproperties-na-pratica/">CustomDocumentProperties na prática</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


			</nav>
		</div>
		<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>Nesta página</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#desativando-a-atualização-da-planilha">Desativando a atualização da planilha</a></li>
    <li><a href="#otimizando-a-pesquisa-de-erros-por-depuração-estendida">Otimizando a pesquisa de erros por depuração estendida</a></li>
    <li><a href="#verificando-o-tempo-de-execução">Verificando o tempo de execução</a></li>
    <li><a href="#usando-com-blocos">Usando com blocos</a></li>
    <li><a href="#exclusão-de-linha---desempenho">Exclusão de linha - Desempenho</a></li>
    <li><a href="#desativando-todas-as-funcionalidades-do-excel-antes-de-executar-macros-grandes">Desativando todas as funcionalidades do Excel Antes de executar macros grandes</a></li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>Nesta página</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#desativando-a-atualização-da-planilha">Desativando a atualização da planilha</a></li>
    <li><a href="#otimizando-a-pesquisa-de-erros-por-depuração-estendida">Otimizando a pesquisa de erros por depuração estendida</a></li>
    <li><a href="#verificando-o-tempo-de-execução">Verificando o tempo de execução</a></li>
    <li><a href="#usando-com-blocos">Usando com blocos</a></li>
    <li><a href="#exclusão-de-linha---desempenho">Exclusão de linha - Desempenho</a></li>
    <li><a href="#desativando-todas-as-funcionalidades-do-excel-antes-de-executar-macros-grandes">Desativando todas as funcionalidades do Excel Antes de executar macros grandes</a></li>
  </ul>
</nav>
  </div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="/pt/">Home</a></li>
<li class="breadcrumb-item"><a href="/pt/docs/">Docs</a></li>
<li class="breadcrumb-item"><a href="/pt/docs/excel-vba/">tutorial excel-vba</a></li>
<li class="breadcrumb-item active" aria-current="page">Otimização Excel-VBA</li>
					</ol>
				</nav>
			
			<h1>Otimização Excel-VBA</h1>
			<p class="lead"></p>
			<nav class="d-xl-none" aria-label="Quaternary navigation">
				<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>Nesta página</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#desativando-a-atualização-da-planilha">Desativando a atualização da planilha</a></li>
    <li><a href="#otimizando-a-pesquisa-de-erros-por-depuração-estendida">Otimizando a pesquisa de erros por depuração estendida</a></li>
    <li><a href="#verificando-o-tempo-de-execução">Verificando o tempo de execução</a></li>
    <li><a href="#usando-com-blocos">Usando com blocos</a></li>
    <li><a href="#exclusão-de-linha---desempenho">Exclusão de linha - Desempenho</a></li>
    <li><a href="#desativando-todas-as-funcionalidades-do-excel-antes-de-executar-macros-grandes">Desativando todas as funcionalidades do Excel Antes de executar macros grandes</a></li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>Nesta página</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#desativando-a-atualização-da-planilha">Desativando a atualização da planilha</a></li>
    <li><a href="#otimizando-a-pesquisa-de-erros-por-depuração-estendida">Otimizando a pesquisa de erros por depuração estendida</a></li>
    <li><a href="#verificando-o-tempo-de-execução">Verificando o tempo de execução</a></li>
    <li><a href="#usando-com-blocos">Usando com blocos</a></li>
    <li><a href="#exclusão-de-linha---desempenho">Exclusão de linha - Desempenho</a></li>
    <li><a href="#desativando-todas-as-funcionalidades-do-excel-antes-de-executar-macros-grandes">Desativando todas as funcionalidades do Excel Antes de executar macros grandes</a></li>
  </ul>
</nav>
  </div>

			</nav>
			<p>Otimização Excel-VBA também se refere à codificação melhor tratamento de erros por documentação e detalhes adicionais. Isso é mostrado aqui.</p>
<p>*) Os números de linha representados são inteiros, ou seja, um tipo de dados de 16 bits com sinal no intervalo de -32.768 a 32.767, caso contrário, você produzirá um estouro. Normalmente os números de linha são inseridos em passos de 10 sobre uma parte do código ou todos os procedimentos de um módulo como um todo.</p>
<h2 id="desativando-a-atualização-da-planilha">Desativando a atualização da planilha <a href="#desativando-a-atualiza%c3%a7%c3%a3o-da-planilha" class="anchor" aria-hidden="true">#</a></h2>
<p>Desabilitar o cálculo da planilha pode diminuir significativamente o tempo de execução da macro. Além disso, desabilitar eventos, atualização de tela e quebras de página seriam benéficos. O seguinte <code>Sub</code> pode ser usado em qualquer macro para esta finalidade.</p>
<pre><code>Sub OptimizeVBA(isOn As Boolean)
    Application.Calculation = IIf(isOn, xlCalculationManual, xlCalculationAutomatic)
    Application.EnableEvents = Not(isOn)
    Application.ScreenUpdating = Not(isOn)
    ActiveSheet.DisplayPageBreaks = Not(isOn)
End Sub
</code></pre>
<p>Para otimização siga o pseudo-código abaixo:</p>
<pre><code>Sub MyCode()
    
    OptimizeVBA True

    'Your code goes here

    OptimizeVBA False

End Sub
</code></pre>
<h2 id="otimizando-a-pesquisa-de-erros-por-depuração-estendida">Otimizando a pesquisa de erros por depuração estendida <a href="#otimizando-a-pesquisa-de-erros-por-depura%c3%a7%c3%a3o-estendida" class="anchor" aria-hidden="true">#</a></h2>
<p><strong>Usando números de linha&hellip; e documentando-os em caso de erro</strong>
(&ldquo;A importância de ver Erl&rdquo;)</p>
<p>Detectar qual linha gera um erro é uma parte substancial de qualquer depuração e restringe a busca pela causa. Documentar as linhas de erro identificadas com uma breve descrição completa um rastreamento de erro bem-sucedido, na melhor das hipóteses junto com os nomes do módulo e do procedimento. O exemplo abaixo salva esses dados em um arquivo de log.</p>
<p><strong>Fundo</strong></p>
<p>O objeto de erro retorna o número do erro (Err.Number) e a descrição do erro (Err.Description), mas não responde explicitamente à pergunta onde localizar o erro. A função <strong>Erl</strong>, no entanto, faz, mas com a condição de que você adicione *<em>números de linha <em>)</em></em> ao código (BTW uma das várias outras concessões aos tempos básicos anteriores).</p>
<p>Se não houver nenhuma linha de erro, a função Erl retornará 0, se a numeração estiver incompleta, você obterá o último número da linha anterior do procedimento.</p>
<pre><code>Option Explicit


Public Sub MyProc1()
Dim i As Integer
Dim j As Integer
On Error GoTo LogErr
10     j = 1 / 0    ' raises an error
okay:
Debug.Print &quot;i=&quot; &amp; i
Exit Sub

LogErr:
MsgBox LogErrors(&quot;MyModule&quot;, &quot;MyProc1&quot;, Err), vbExclamation, &quot;Error &quot; &amp; Err.Number
Stop
Resume Next
End Sub

Public Function LogErrors( _
           ByVal sModule As String, _
           ByVal sProc As String, _
           Err As ErrObject) As String
' Purpose: write error number, description and Erl to log file and return error text
  Dim sLogFile As String: sLogFile = ThisWorkbook.Path &amp; Application.PathSeparator &amp; &quot;LogErrors.txt&quot;
  Dim sLogTxt  As String
  Dim lFile    As Long

' Create error text
  sLogTxt = sModule &amp; &quot;|&quot; &amp; sProc &amp; &quot;|Erl &quot; &amp; Erl &amp; &quot;|Err &quot; &amp; Err.Number &amp; &quot;|&quot; &amp; Err.Description

  On Error Resume Next
  lFile = FreeFile

  Open sLogFile For Append As lFile
  Print #lFile, Format$(Now(), &quot;yy.mm.dd hh:mm:ss &quot;); sLogTxt
      Print #lFile,
  Close lFile
' Return error text
  LogErrors = sLogTxt
 End Function
</code></pre>
<p>&lsquo;<strong>Código adicional para mostrar o arquivo de log</strong></p>
<pre><code>Sub ShowLogFile()
Dim sLogFile As String: sLogFile = ThisWorkbook.Path &amp; Application.PathSeparator &amp; &quot;LogErrors.txt&quot;

On Error GoTo LogErr
Shell &quot;notepad.exe &quot; &amp; sLogFile, vbNormalFocus

okay:
On Error Resume Next
Exit Sub

LogErr:
MsgBox LogErrors(&quot;MyModule&quot;, &quot;ShowLogFile&quot;, Err), vbExclamation, &quot;Error No &quot; &amp; Err.Number
Resume okay
End Sub
</code></pre>
<h2 id="verificando-o-tempo-de-execução">Verificando o tempo de execução <a href="#verificando-o-tempo-de-execu%c3%a7%c3%a3o" class="anchor" aria-hidden="true">#</a></h2>
<p>Procedimentos diferentes podem fornecer o mesmo resultado, mas usariam tempos de processamento diferentes. Para verificar qual é mais rápido, um código como este pode ser usado:</p>
<pre><code>time1 = Timer

For Each iCell In MyRange
   iCell = &quot;text&quot;
Next iCell

time2 = Timer

For i = 1 To 30
   MyRange.Cells(i) = &quot;text&quot;
Next i

time3 = Timer

debug.print &quot;Proc1 time: &quot; &amp; cStr(time2-time1)
debug.print &quot;Proc2 time: &quot; &amp; cStr(time3-time2)
</code></pre>
<hr>
<p><a href="https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5">MicroTimer</a>:</p>
<pre><code>Private Declare PtrSafe Function getFrequency Lib &quot;Kernel32&quot; Alias &quot;QueryPerformanceFrequency&quot; (cyFrequency As Currency) As Long
Private Declare PtrSafe Function getTickCount Lib &quot;Kernel32&quot; Alias &quot;QueryPerformanceCounter&quot; (cyTickCount As Currency) As Long

Function MicroTimer() As Double
    Dim cyTicks1 As Currency
    Static cyFrequency As Currency

    MicroTimer = 0
    If cyFrequency = 0 Then getFrequency cyFrequency        'Get frequency
    getTickCount cyTicks1                                   'Get ticks
    If cyFrequency Then MicroTimer = cyTicks1 / cyFrequency 'Returns Seconds
End Function
</code></pre>
<h2 id="usando-com-blocos">Usando com blocos <a href="#usando-com-blocos" class="anchor" aria-hidden="true">#</a></h2>
<p>O uso com blocos pode acelerar o processo de execução de uma macro. Em vez de escrever um intervalo, nome de gráfico, planilha, etc., você pode usar blocos com como abaixo;</p>
<pre><code>With ActiveChart
    .Parent.Width = 400
    .Parent.Height = 145
    .Parent.Top = 77.5 + 165 * step - replacer * 15
    .Parent.Left = 5
End With 
</code></pre>
<p>O que é mais rápido que isso:</p>
<pre><code>ActiveChart.Parent.Width = 400
ActiveChart.Parent.Height = 145
ActiveChart.Parent.Top = 77.5 + 165 * step - replacer * 15
ActiveChart.Parent.Left = 5
</code></pre>
<hr>
<p>Notas:</p>
<ul>
<li>
<p>Uma vez que um bloco With é inserido, o objeto não pode ser alterado. Como resultado, você não pode usar uma única instrução With para afetar vários objetos diferentes</p>
</li>
<li>
<p><strong>Não entre ou saia com blocos</strong>. Se as instruções em um bloco With forem executadas, mas a instrução With ou End With não for executada, <strong>uma variável temporária contendo uma referência ao objeto permanece na memória até que você saia do procedimento</strong></p>
</li>
<li>
<p>Não faça loop dentro de instruções With, especialmente se o objeto em cache for usado como um iterador</p>
</li>
<li>
<p>Você pode aninhar instruções With colocando um bloco With dentro de outro. No entanto, como os membros dos blocos With externos são mascarados nos blocos With internos, você deve fornecer uma referência de objeto totalmente qualificada em um bloco With interno para qualquer membro de um objeto em um bloco With externo.</p>
</li>
</ul>
<p>Exemplo de aninhamento:</p>
<p>Este exemplo usa a instrução With para executar uma série de instruções em um único objeto.
O objeto e suas propriedades são nomes genéricos usados ​​apenas para fins de ilustração.</p>
<pre><code>With MyObject 
    .Height = 100               'Same as MyObject.Height = 100. 
    .Caption = &quot;Hello World&quot;    'Same as MyObject.Caption = &quot;Hello World&quot;. 
    With .Font 
        .Color = Red            'Same as MyObject.Font.Color = Red. 
        .Bold = True            'Same as MyObject.Font.Bold = True. 
        MyObject.Height = 200   'Inner-most With refers to MyObject.Font (must be qualified
    End With
End With
</code></pre>
<p>Mais informações sobre <a href="https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/with-statement">MSDN</a></p>
<h2 id="exclusão-de-linha---desempenho">Exclusão de linha - Desempenho <a href="#exclus%c3%a3o-de-linha---desempenho" class="anchor" aria-hidden="true">#</a></h2>
<ul>
<li>
<p>A exclusão de linhas é lenta, especialmente ao percorrer células e excluir linhas, uma a uma</p>
</li>
<li>
<p>Uma abordagem diferente é usar um AutoFilter para ocultar as linhas a serem excluídas</p>
</li>
<li>
<p>Copie o intervalo visível e cole-o em uma nova planilha</p>
</li>
<li>
<p>Remova totalmente a folha inicial</p>
</li>
<li>
<p>Com este método, quanto mais linhas excluir, mais rápido será</p>
</li>
</ul>
<p>Exemplo:</p>
<pre><code>Option Explicit

'Deleted rows: 775,153, Total Rows: 1,000,009, Duration: 1.87 sec

Public Sub DeleteRows()
    Dim oldWs As Worksheet, newWs As Worksheet, wsName As String, ur As Range

    Set oldWs = ThisWorkbook.ActiveSheet
    wsName = oldWs.Name
    Set ur = oldWs.Range(&quot;F2&quot;, oldWs.Cells(oldWs.Rows.Count, &quot;F&quot;).End(xlUp))

    Application.ScreenUpdating = False
    Set newWs = Sheets.Add(After:=oldWs)    'Create a new WorkSheet

    With ur    'Copy visible range after Autofilter (modify Criteria1 and 2 accordingly)
        .AutoFilter Field:=1, Criteria1:=&quot;&lt;&gt;0&quot;, Operator:=xlAnd, Criteria2:=&quot;&lt;&gt;&quot;
        oldWs.UsedRange.Copy
    End With
    'Paste all visible data into the new WorkSheet (values and formats)
    With newWs.Range(oldWs.UsedRange.Cells(1).Address)
        .PasteSpecial xlPasteColumnWidths
        .PasteSpecial xlPasteAll
        newWs.Cells(1, 1).Select: newWs.Cells(1, 1).Copy
    End With

    With Application
        .CutCopyMode = False
        .DisplayAlerts = False
            oldWs.Delete
        .DisplayAlerts = True
        .ScreenUpdating = True
    End With
    newWs.Name = wsName
End Sub
</code></pre>
<h2 id="desativando-todas-as-funcionalidades-do-excel-antes-de-executar-macros-grandes">Desativando todas as funcionalidades do Excel Antes de executar macros grandes <a href="#desativando-todas-as-funcionalidades-do-excel-antes-de-executar-macros-grandes" class="anchor" aria-hidden="true">#</a></h2>
<p>Os procedimentos abaixo desabilitarão temporariamente todos os recursos do Excel no nível da Pasta de Trabalho e da Planilha</p>
<ul>
<li>
<p>FastWB() é uma alternância que aceita sinalizadores On ou Off</p>
</li>
<li>
<p>FastWS() aceita um objeto WorkSheet opcional ou nenhum</p>
</li>
<li>
<p>Se o parâmetro ws estiver ausente, ele ativará e desativará todos os recursos para todas as WorkSheets na coleção</p>
</li>
<li>
<p>Um tipo personalizado pode ser usado para capturar todas as configurações antes de desativá-las</p>
</li>
<li>
<p>Ao final do processo, as configurações iniciais podem ser restauradas</p>
</li>
</ul>
<hr>
<pre><code>Public Sub FastWB(Optional ByVal opt As Boolean = True)
    With Application
        .Calculation = IIf(opt, xlCalculationManual, xlCalculationAutomatic)
        If .DisplayAlerts &lt;&gt; Not opt Then .DisplayAlerts = Not opt
        If .DisplayStatusBar &lt;&gt; Not opt Then .DisplayStatusBar = Not opt
        If .EnableAnimations &lt;&gt; Not opt Then .EnableAnimations = Not opt
        If .EnableEvents &lt;&gt; Not opt Then .EnableEvents = Not opt
        If .ScreenUpdating &lt;&gt; Not opt Then .ScreenUpdating = Not opt
    End With
    FastWS , opt
End Sub
</code></pre>
<hr>
<pre><code>Public Sub FastWS(Optional ByVal ws As Worksheet, Optional ByVal opt As Boolean = True)
    If ws Is Nothing Then
        For Each ws In Application.ThisWorkbook.Sheets
            OptimiseWS ws, opt
        Next
    Else
        OptimiseWS ws, opt
    End If
End Sub
Private Sub OptimiseWS(ByVal ws As Worksheet, ByVal opt As Boolean)
    With ws
        .DisplayPageBreaks = False
        .EnableCalculation = Not opt
        .EnableFormatConditionsCalculation = Not opt
        .EnablePivotTable = Not opt
    End With
End Sub
</code></pre>
<hr>
<p>Restaurar todas as configurações do Excel para o padrão</p>
<pre><code>Public Sub XlResetSettings()    'default Excel settings
    With Application
        .Calculation = xlCalculationAutomatic
        .DisplayAlerts = True
        .DisplayStatusBar = True
        .EnableAnimations = False
        .EnableEvents = True
        .ScreenUpdating = True
        Dim sh As Worksheet
        For Each sh In Application.ThisWorkbook.Sheets
            With sh
                .DisplayPageBreaks = False
                .EnableCalculation = True
                .EnableFormatConditionsCalculation = True
                .EnablePivotTable = True
            End With
        Next
    End With
End Sub
</code></pre>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				</div>
			<div class="docs-navigation d-flex justify-content-between">
	
	
		<a href="/pt/excel-vba/formatacao-condicional-usando-vba/">
						<div class="card my-1">
							<div class="card-body py-2">
								&larr; Formatação condicional usando VBA
							</div>
						</div>
					</a>
				<a class="ms-auto" href="/pt/excel-vba/integracao-do-powerpoint-atraves-do-vba/">
						<div class="card my-1">
							<div class="card-body py-2">
								Integração do PowerPoint através do VBA &rarr;
							</div>
						</div>
					</a>
				
	
	</div>

			
		</main>
	</div>

      </div>
    </div>
    
    
    <footer class="footer text-muted">
  <div class="container-xxl">
    <div class="row">
      <div class="col-lg-8 order-last order-lg-first">
        <ul class="list-inline">
          <li class="list-inline-item">Copyright © 2018-2022 Wikiod.</li>
        </ul>
      </div>
      <div class="col-lg-8 order-first order-lg-last text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item"><a href="/pt/about/">cerca de</a></li>
          <li class="list-inline-item"><a href="/pt/disclaimers/">Isenções de responsabilidade</a></li>
          <li class="list-inline-item"><a href="/pt/dcma/">DCMA</a></li>
          <li class="list-inline-item"><a href="/pt/terms-of-use/">Termos de uso</a></li>
          <li class="list-inline-item"><a href="/pt/privacy-policy/">Política de Privacidade</a></li>
          </ul>
      </div>
    </div>
  </div>
</footer>
    

<script src="/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js" integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51&#43;L6gymJi4Qg==" crossorigin="anonymous" defer></script>
  <script src="/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js" integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin="anonymous" defer></script>
  <script src="/main.min.4971645518aa07968852c38e2c8051abe697181395ad03d5fa0eb28e42edf5f54f801de05c98298ce77b65223caf97b7ea259fbca096e64b3840985ec069e2ef.js" integrity="sha512-SXFkVRiqB5aIUsOOLIBRq&#43;aXGBOVrQPV&#43;g6yjkLt9fVPgB3gXJgpjOd7ZSI8r5e36iWfvKCW5ks4QJhewGni7w==" crossorigin="anonymous" defer></script>
  
    
  </body>
</html>