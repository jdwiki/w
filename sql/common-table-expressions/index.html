<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-500.woff2" type="font/woff2" crossorigin>
<link rel="preload" as="font" href="https://www.wikiod.com/fonts/vendor/jost/jost-v4-latin-700.woff2" type="font/woff2" crossorigin>

  <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>

  <link rel="stylesheet" href="https://www.wikiod.com/main.7636753edc6f50e96b0045eba39982b1b0b2b6947250d1080bec1f4cbe52399ea6bcecac0e0b6026886b51bdbde879ec9a9820765b03caead79d8ddf3b79336f.css" integrity="sha512-djZ1PtxvUOlrAEXro5mCsbCytpRyUNEIC&#43;wfTL5SOZ6mvOysDgtgJohrUb296HnsmpggdlsDyurXnY3fO3kzbw==" crossorigin="anonymous">
<noscript><style>img.lazyload { display: none; }</style></noscript>
  <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <title>Common Table Expressions - WikiOD</title>
<meta name="description" content="Syntax # WITH QueryName [(ColumnName, &amp;hellip;)] AS (
SELECT &amp;hellip;
)
SELECT &amp;hellip; FROM QueryName &amp;hellip;;
WITH RECURSIVE QueryName [(ColumnName, &amp;hellip;)] AS (
SELECT &amp;hellip;
UNION [ALL]
SELECT &amp;hellip; FROM QueryName &amp;hellip;
)
SELECT &amp;hellip; FROM QueryName &amp;hellip;;
Official documentation: WITH clause
A Common Table Expression is a temporary result set, and it can be result of complex sub query. It is defined by using WITH clause. CTE improves readability and it is created in memory rather than TempDB database where Temp Table and Table variable is created.">
  <link rel="canonical" href="https://www.wikiod.com/sql/common-table-expressions/">
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Common Table Expressions">
<meta property="og:description" content="Syntax # WITH QueryName [(ColumnName, &hellip;)] AS (
SELECT &hellip;
)
SELECT &hellip; FROM QueryName &hellip;;
WITH RECURSIVE QueryName [(ColumnName, &hellip;)] AS (
SELECT &hellip;
UNION [ALL]
SELECT &hellip; FROM QueryName &hellip;
)
SELECT &hellip; FROM QueryName &hellip;;
Official documentation: WITH clause
A Common Table Expression is a temporary result set, and it can be result of complex sub query. It is defined by using WITH clause. CTE improves readability and it is created in memory rather than TempDB database where Temp Table and Table variable is created.">
<meta property="og:url" content="https://www.wikiod.com/sql/common-table-expressions/">
<meta property="og:site_name" content="WikiOD">

  <meta property="og:image" content="https://www.wikiod.com/wikiod_logo.png"/>
      <meta property="og:image:alt" content="WikiOD">
    
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@wikiod">
<meta name="twitter:creator" content="@wikiod">
<meta name="twitter:title" content="Common Table Expressions">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://www.wikiod.com/wikiod_logo.png">
    <meta name="twitter:image:alt" content="Common Table Expressions">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
        "@id": "https://www.wikiod.com/#/schema/organization/1",
      "name": "WikiOD",
      "url": "https://www.wikiod.com/",
      "sameAs": [
        "https://twitter.com/wikiod"
        , "https://github.com/wikiod-com"
        ],
      "logo": {
          "@type": "ImageObject",
          "@id": "https://www.wikiod.com/#/schema/image/1",
          "url": "https://www.wikiod.com/wikiod_logo.png",
          "width":  512 ,
          "height":  512 ,
          "caption": "WikiOD"
        },
        "image": {
          "@id": "https://www.wikiod.com/#/schema/image/1"
        }
      },
    {
      "@type": "WebSite",
      "@id": "https://www.wikiod.com/#/schema/website/1",
      "url": "https://www.wikiod.com/",
      "name": "WikiOD",
      "description": "Welcome to WikiOD - Wiki Online Documentation WikiOD is a collaborative writing project to build the highest quality online documentation of all programming languages, education-related subjects and concepts.",
      "publisher": {
          "@id": "https://www.wikiod.com/#/schema/organization/1"
        }
      },
    {
      "@type": "WebPage",
      "@id": "https://www.wikiod.com/sql/common-table-expressions/",
      "url": "https://www.wikiod.com/sql/common-table-expressions/",
      "name": "Common Table Expressions",
      "description": "",
      "isPartOf": {
        "@id": "https://www.wikiod.com/#/schema/website/1"
      },
      "about": {
          "@id": "https://www.wikiod.com/#/schema/organization/1"
        },
      "datePublished": "0001-01-01T00:00:00CET",
      "dateModified": "0001-01-01T00:00:00CET",
      "breadcrumb": {
        "@id": "https://www.wikiod.com/sql/common-table-expressions/#/schema/breadcrumb/1"
      },
      "primaryImageOfPage": {
        "@id": "https://www.wikiod.com/sql/common-table-expressions/#/schema/image/2"
      },
      "inLanguage": "en",
      "potentialAction": [{
        "@type": "ReadAction", "target": ["https://www.wikiod.com/sql/common-table-expressions/"]
      }]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://www.wikiod.com/sql/common-table-expressions/#/schema/breadcrumb/1",
      "name": "Breadcrumbs",
      "itemListElement": [{
        "@type": "ListItem",
        "position":  1 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/",
          "url": "https://www.wikiod.com/",
          "name": "Home"
          }
        },{
        "@type": "ListItem",
        "position":  2 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://www.wikiod.com/sql/",
          "url": "https://www.wikiod.com/sql/",
          "name": "SQL"
          }
        },{
        "@type": "ListItem",
        "position":  3 ,
        "item": {
          "@id": "https://www.wikiod.com/sql/common-table-expressions/"
          }
        }]
    },

    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Article",
          "@id": "https://www.wikiod.com/#/schema/article/1",
          "headline": "Common Table Expressions",
          "description": "",
          "isPartOf": {
            "@id": "https://www.wikiod.com/sql/common-table-expressions/"
          },
          "mainEntityOfPage": {
            "@id": "https://www.wikiod.com/sql/common-table-expressions/"
          },
          "datePublished": "0001-01-01T00:00:00CET",
          "dateModified": "0001-01-01T00:00:00CET",
          "author": {
            "@id": "https://www.wikiod.com/#/schema/person/2"
          },
          "publisher": {
              "@id": "https://www.wikiod.com/#/schema/organization/1"
            },
          "image": {
            "@id": "https://www.wikiod.com/sql/common-table-expressions/#/schema/image/2"
          }
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Person",
          "@id": "https://www.wikiod.com/#/schema/person/2",
          "name": "WikiOD",
          "sameAs": [
            "https://twitter.com/wikiod"
            , "https://github.com/wikiod-com"
            ]
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "ImageObject",
          "@id": "https://www.wikiod.com/sql/common-table-expressions/#/schema/image/2",
          "url": "https://www.wikiod.com/wikiod_logo.png",
          "contentUrl": "https://www.wikiod.com/wikiod_logo.png",
          "caption": "Common Table Expressions"
        }
      ]
    }

  ]
}
</script>

  <meta name="theme-color" content="#fff">
<link rel="icon" href="https://www.wikiod.com/favicon.ico" sizes="any">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.wikiod.com/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.wikiod.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.wikiod.com/favicon-16x16.png">
<link rel="manifest" crossorigin="use-credentials" href="https://www.wikiod.com/site.webmanifest">

  
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9345677191971886" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y7ZZF8Q2L4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y7ZZF8Q2L4');
</script>

</head>

  <body class="docs single">
    <div class="sticky-top">
<div class="header-bar"></div>

<header class="navbar navbar-expand-lg navbar-light doks-navbar">
  <nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation">

    <a class="navbar-brand order-0" href="/" aria-label="WikiOD">
      WikiOD
    </a>

    <button class="btn btn-link order-0 ms-auto d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
    </button>
    <div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
      <div class="header-bar"></div>
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasExampleLabel">Browse docs</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <aside class="doks-sidebar mt-n3">
          <nav id="doks-docs-nav" aria-label="Tertiary navigation">
            

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/docs/sql/"><h3 class="h6 text-uppercase mb-2">SQL Tutorial</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/getting-started-with-sql/">Getting started with SQL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/select/">SELECT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/join/">JOIN</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/example-databases-and-tables/">Example Databases and Tables</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/string-functions/">String Functions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/case/">CASE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/filter-results-using-where-and-having/">Filter results using WHERE and HAVING</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-injection/">SQL Injection</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/union--union-all/">UNION  UNION ALL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-table/">CREATE TABLE</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/sql/common-table-expressions/">Common Table Expressions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-aggregate/">Functions (Aggregate)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/subqueries/">Subqueries</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/update/">UPDATE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/skip-take-pagination/">SKIP TAKE (Pagination)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/like-operator/">LIKE operator</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/order-of-execution/">Order of Execution</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/group-by/">GROUP BY</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/stored-procedures/">Stored Procedures</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/insert/">INSERT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/merge/">MERGE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/window-functions/">Window Functions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/indexes/">Indexes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/data-types/">Data Types</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/null/">NULL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/cross-apply-outer-apply/">cross apply, outer apply</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/alter-table/">ALTER TABLE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/triggers/">Triggers</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-cursor/">SQL CURSOR</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/clean-code-in-sql/">Clean Code in SQL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/views/">Views</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/grant-and-revoke/">GRANT and REVOKE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/except/">EXCEPT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/transactions/">Transactions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/finding-duplicates-on-a-column-subset-with-detail/">Finding Duplicates on a Column Subset with Detail</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/primary-keys/">Primary Keys</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/truncate/">TRUNCATE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/explain-and-describe/">EXPLAIN and DESCRIBE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/trycatch/">TRYCATCH</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-function/">CREATE FUNCTION</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/order-by/">ORDER BY</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sequence/">Sequence</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/in-clause/">IN clause</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/delete/">DELETE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-group-by-vs-distinct/">SQL Group By vs Distinct</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/foreign-keys/">Foreign Keys</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/table-design/">Table Design</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-analytic/">Functions (Analytic)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-scalarsingle-row/">Functions (ScalarSingle Row)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/information-schema/">Information Schema</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/xml/">XML</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/cascading-delete/">Cascading Delete</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/execution-blocks/">Execution blocks</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/row-number/">Row number</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/exists-clause/">EXISTS CLAUSE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/relational-algebra/">Relational Algebra</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/materialized-views/">Materialized Views</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/and--or-operators/">AND &amp; OR Operators</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/synonyms/">Synonyms</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/comments/">Comments</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/drop-table/">DROP Table</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-database/">CREATE Database</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/drop-or-delete-database/">DROP or DELETE Database</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/identifier/">Identifier</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


          </nav>
        </aside>
      </div>
    </div>
    <button class="btn btn-menu order-2 d-block d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDoks" aria-controls="offcanvasDoks" aria-label="Open main menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>
    <div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex="-1" id="offcanvasDoks" data-bs-backdrop="true" aria-labelledby="offcanvasDoksLabel">
      <div class="header-bar d-lg-none"></div>
      <div class="offcanvas-header d-lg-none">
        <h2 class="h5 offcanvas-title ps-2" id="offcanvasDoksLabel"><a class="text-dark" href="/">WikiOD</a></h2>
        <button type="button" class="btn-close text-reset me-2" data-bs-dismiss="offcanvas" aria-label="Close main menu"></button>
      </div>
      <div class="offcanvas-body p-4 p-lg-0">
        <ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto">
              <li class="nav-item">
                <a class="nav-link ps-0 py-1" href="/docs/">Tutorials</a>
              </li>
            
          
              <li class="nav-item">
                <a class="nav-link ps-0 py-1" href="/blog/">Articles</a>
              </li>
            
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <ul class="nav flex-column flex-lg-row">
          </ul>

        <hr class="text-black-50 my-4 d-lg-none">
        <button id="mode" class="btn btn-link" type="button" aria-label="Toggle user interface mode">
          <span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
          <span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
        </button>
        <hr class="text-black-50 my-4 d-lg-none">
        <div class="dropdown">
          <button class="btn btn-doks-light dropdown-toggle" id="doks-languages" data-bs-toggle="dropdown" aria-expanded="false" data-bs-display="static">
            English
            <span class="dropdown-caret"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-lg-end me-lg-2 shadow rounded border-0" aria-labelledby="doks-languages">

            <li><a class="dropdown-item current" aria-current="true" href="/sql/common-table-expressions/">English</a></li>

            <li><hr class="dropdown-divider"></li>

            
                <li><a class="dropdown-item" rel="alternate" href="/es/sql/expresiones-de-tabla-comunes/" hreflang="es" lang="es">Español</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/fr/sql/expressions-de-table-courantes/" hreflang="fr" lang="fr">Français</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/pt/sql/expressoes-de-tabela-comuns/" hreflang="pt" lang="pt">Português</a></li>
              
                <li><a class="dropdown-item" rel="alternate" href="/tr/sql/ortak-tablo-ifadeleri/" hreflang="tr" lang="tr">Türk</a></li>
              
          </ul>
        </div>
        </div>
    </div>
  </nav>
</header>


</div>
<div class="container-xxl">
  <aside class="doks-sidebar">
    <nav id="doks-docs-nav" class="collapse d-lg-none" aria-label="Tertiary navigation">
      

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/docs/sql/"><h3 class="h6 text-uppercase mb-2">SQL Tutorial</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/getting-started-with-sql/">Getting started with SQL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/select/">SELECT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/join/">JOIN</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/example-databases-and-tables/">Example Databases and Tables</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/string-functions/">String Functions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/case/">CASE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/filter-results-using-where-and-having/">Filter results using WHERE and HAVING</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-injection/">SQL Injection</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/union--union-all/">UNION  UNION ALL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-table/">CREATE TABLE</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/sql/common-table-expressions/">Common Table Expressions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-aggregate/">Functions (Aggregate)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/subqueries/">Subqueries</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/update/">UPDATE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/skip-take-pagination/">SKIP TAKE (Pagination)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/like-operator/">LIKE operator</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/order-of-execution/">Order of Execution</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/group-by/">GROUP BY</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/stored-procedures/">Stored Procedures</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/insert/">INSERT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/merge/">MERGE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/window-functions/">Window Functions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/indexes/">Indexes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/data-types/">Data Types</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/null/">NULL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/cross-apply-outer-apply/">cross apply, outer apply</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/alter-table/">ALTER TABLE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/triggers/">Triggers</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-cursor/">SQL CURSOR</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/clean-code-in-sql/">Clean Code in SQL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/views/">Views</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/grant-and-revoke/">GRANT and REVOKE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/except/">EXCEPT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/transactions/">Transactions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/finding-duplicates-on-a-column-subset-with-detail/">Finding Duplicates on a Column Subset with Detail</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/primary-keys/">Primary Keys</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/truncate/">TRUNCATE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/explain-and-describe/">EXPLAIN and DESCRIBE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/trycatch/">TRYCATCH</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-function/">CREATE FUNCTION</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/order-by/">ORDER BY</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sequence/">Sequence</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/in-clause/">IN clause</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/delete/">DELETE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-group-by-vs-distinct/">SQL Group By vs Distinct</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/foreign-keys/">Foreign Keys</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/table-design/">Table Design</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-analytic/">Functions (Analytic)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-scalarsingle-row/">Functions (ScalarSingle Row)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/information-schema/">Information Schema</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/xml/">XML</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/cascading-delete/">Cascading Delete</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/execution-blocks/">Execution blocks</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/row-number/">Row number</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/exists-clause/">EXISTS CLAUSE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/relational-algebra/">Relational Algebra</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/materialized-views/">Materialized Views</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/and--or-operators/">AND &amp; OR Operators</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/synonyms/">Synonyms</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/comments/">Comments</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/drop-table/">DROP Table</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-database/">CREATE Database</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/drop-or-delete-database/">DROP or DELETE Database</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/identifier/">Identifier</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


    </nav>
  </aside>
</div>


    <div class="wrap container-xxl" role="document">
      <div class="content">
        
	<div class="row flex-xl-nowrap">
		<div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block">
			<nav id="sidebar-default" class="docs-links" aria-label="Main navigation">
				

  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
    
    <a href="https://www.wikiod.com/docs/sql/"><h3 class="h6 text-uppercase mb-2">SQL Tutorial</h3></a>
    <ul class="list-unstyled">
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/getting-started-with-sql/">Getting started with SQL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/select/">SELECT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/join/">JOIN</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/example-databases-and-tables/">Example Databases and Tables</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/string-functions/">String Functions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/case/">CASE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/filter-results-using-where-and-having/">Filter results using WHERE and HAVING</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-injection/">SQL Injection</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/union--union-all/">UNION  UNION ALL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-table/">CREATE TABLE</a></li>
        
      
      
        
          
          <li><a class="docs-link active" href="https://www.wikiod.com/sql/common-table-expressions/">Common Table Expressions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-aggregate/">Functions (Aggregate)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/subqueries/">Subqueries</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/update/">UPDATE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/skip-take-pagination/">SKIP TAKE (Pagination)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/like-operator/">LIKE operator</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/order-of-execution/">Order of Execution</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/group-by/">GROUP BY</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/stored-procedures/">Stored Procedures</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/insert/">INSERT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/merge/">MERGE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/window-functions/">Window Functions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/indexes/">Indexes</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/data-types/">Data Types</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/null/">NULL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/cross-apply-outer-apply/">cross apply, outer apply</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/alter-table/">ALTER TABLE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/triggers/">Triggers</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-cursor/">SQL CURSOR</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/clean-code-in-sql/">Clean Code in SQL</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/views/">Views</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/grant-and-revoke/">GRANT and REVOKE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/except/">EXCEPT</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/transactions/">Transactions</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/finding-duplicates-on-a-column-subset-with-detail/">Finding Duplicates on a Column Subset with Detail</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/primary-keys/">Primary Keys</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/truncate/">TRUNCATE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/explain-and-describe/">EXPLAIN and DESCRIBE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/trycatch/">TRYCATCH</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-function/">CREATE FUNCTION</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/order-by/">ORDER BY</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sequence/">Sequence</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/in-clause/">IN clause</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/delete/">DELETE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/sql-group-by-vs-distinct/">SQL Group By vs Distinct</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/foreign-keys/">Foreign Keys</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/table-design/">Table Design</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-analytic/">Functions (Analytic)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/functions-scalarsingle-row/">Functions (ScalarSingle Row)</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/information-schema/">Information Schema</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/xml/">XML</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/cascading-delete/">Cascading Delete</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/execution-blocks/">Execution blocks</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/row-number/">Row number</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/exists-clause/">EXISTS CLAUSE</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/relational-algebra/">Relational Algebra</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/materialized-views/">Materialized Views</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/and--or-operators/">AND &amp; OR Operators</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/synonyms/">Synonyms</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/comments/">Comments</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/drop-table/">DROP Table</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/create-database/">CREATE Database</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/drop-or-delete-database/">DROP or DELETE Database</a></li>
        
      
      
        
          
          <li><a class="docs-link" href="https://www.wikiod.com/sql/identifier/">Identifier</a></li>
        
      
    </ul>
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  


			</nav>
		</div>
		<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>On this page</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#syntax">Syntax</a></li>
    <li><a href="#generating-values">generating values</a></li>
    <li><a href="#recursively-enumerating-a-subtree">recursively enumerating a subtree</a></li>
    <li><a href="#temporary-query">Temporary query</a></li>
    <li><a href="#recursively-going-up-in-a-tree">recursively going up in a tree</a></li>
    <li><a href="#recursively-generate-dates-extended-to-include-team-rostering-as-example">Recursively generate dates, extended to include team rostering as example</a></li>
    <li><a href="#oracle-connect-by-functionality-with-recursive-ctes">Oracle CONNECT BY functionality with recursive CTEs</a></li>
    <li><a href="#refactoring-a-query-to-use-common-table-expressions">Refactoring a query to use Common Table Expressions</a></li>
    <li><a href="#example-of-a-complex-sql-with-common-table-expression">Example of a complex SQL with Common Table Expression</a></li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>On this page</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#syntax">Syntax</a></li>
    <li><a href="#generating-values">generating values</a></li>
    <li><a href="#recursively-enumerating-a-subtree">recursively enumerating a subtree</a></li>
    <li><a href="#temporary-query">Temporary query</a></li>
    <li><a href="#recursively-going-up-in-a-tree">recursively going up in a tree</a></li>
    <li><a href="#recursively-generate-dates-extended-to-include-team-rostering-as-example">Recursively generate dates, extended to include team rostering as example</a></li>
    <li><a href="#oracle-connect-by-functionality-with-recursive-ctes">Oracle CONNECT BY functionality with recursive CTEs</a></li>
    <li><a href="#refactoring-a-query-to-use-common-table-expressions">Refactoring a query to use Common Table Expressions</a></li>
    <li><a href="#example-of-a-complex-sql-with-common-table-expression">Example of a complex SQL with Common Table Expression</a></li>
  </ul>
</nav>
  </div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="/">Home</a></li>
<li class="breadcrumb-item"><a href="/docs/">Docs</a></li>
<li class="breadcrumb-item"><a href="/docs/sql/">SQL Tutorial</a></li>
<li class="breadcrumb-item active" aria-current="page">Common Table Expressions</li>
					</ol>
				</nav>
			
			<h1>Common Table Expressions</h1>
			<p class="lead"></p>
			<nav class="d-xl-none" aria-label="Quaternary navigation">
				<div class="d-xl-none">
  <button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#onThisPage" aria-controls="doks-docs-nav" aria-expanded="false" aria-label="Toggle On this page navigation">
    <span>On this page</span>
    <span>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"></polyline><polyline points="17 18 12 13 7 18"></polyline></svg>
    </span>
  </button>
  <div class="collapse" id="onThisPage">
    <div class="card card-body mt-3 py-1">
      <div class="page-links">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#syntax">Syntax</a></li>
    <li><a href="#generating-values">generating values</a></li>
    <li><a href="#recursively-enumerating-a-subtree">recursively enumerating a subtree</a></li>
    <li><a href="#temporary-query">Temporary query</a></li>
    <li><a href="#recursively-going-up-in-a-tree">recursively going up in a tree</a></li>
    <li><a href="#recursively-generate-dates-extended-to-include-team-rostering-as-example">Recursively generate dates, extended to include team rostering as example</a></li>
    <li><a href="#oracle-connect-by-functionality-with-recursive-ctes">Oracle CONNECT BY functionality with recursive CTEs</a></li>
    <li><a href="#refactoring-a-query-to-use-common-table-expressions">Refactoring a query to use Common Table Expressions</a></li>
    <li><a href="#example-of-a-complex-sql-with-common-table-expression">Example of a complex SQL with Common Table Expression</a></li>
  </ul>
</nav>
      </div>
    </div>
  </div>
</div>
<div class="page-links d-none d-xl-block">
  <h3>On this page</h3>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#syntax">Syntax</a></li>
    <li><a href="#generating-values">generating values</a></li>
    <li><a href="#recursively-enumerating-a-subtree">recursively enumerating a subtree</a></li>
    <li><a href="#temporary-query">Temporary query</a></li>
    <li><a href="#recursively-going-up-in-a-tree">recursively going up in a tree</a></li>
    <li><a href="#recursively-generate-dates-extended-to-include-team-rostering-as-example">Recursively generate dates, extended to include team rostering as example</a></li>
    <li><a href="#oracle-connect-by-functionality-with-recursive-ctes">Oracle CONNECT BY functionality with recursive CTEs</a></li>
    <li><a href="#refactoring-a-query-to-use-common-table-expressions">Refactoring a query to use Common Table Expressions</a></li>
    <li><a href="#example-of-a-complex-sql-with-common-table-expression">Example of a complex SQL with Common Table Expression</a></li>
  </ul>
</nav>
  </div>

			</nav>
			<h2 id="syntax">Syntax <a href="#syntax" class="anchor" aria-hidden="true">#</a></h2>
<ul>
<li>
<p>WITH QueryName [(ColumnName, &hellip;)] AS (<br>
  SELECT &hellip;<br>
)<br>
SELECT &hellip; FROM QueryName &hellip;;</p>
</li>
<li>
<p>WITH RECURSIVE QueryName [(ColumnName, &hellip;)] AS (<br>
  SELECT &hellip;<br>
  UNION [ALL]<br>
  SELECT &hellip; FROM QueryName &hellip;<br>
)<br>
SELECT &hellip; FROM QueryName &hellip;;</p>
</li>
</ul>
<p>Official documentation: <a href="http://www.sqlite.org/lang_with.html">WITH clause</a></p>
<p>A Common Table Expression is a temporary result set, and it can be result of complex sub query. It is defined by using WITH clause. CTE improves readability and it is created in memory rather than TempDB database where Temp Table and Table variable is created.</p>
<p><strong>Key concepts of Common Table Expressions:</strong></p>
<ul>
<li>Can be used to break up complex queries, especially complex joins and sub-queries.</li>
<li>Is a way of encapsulating a query definition.</li>
<li>Persist only until the next query is run.</li>
<li>Correct use can lead to improvements in both code quality/maintainability and speed.</li>
<li>Can be used to reference the resulting table multiple times in the same statement (eliminate duplication in SQL).</li>
<li>Can be a substitute for a view when the general use of a view is not required; that is, you do not have to store the definition in metadata.</li>
<li>Will be run when called, not when defined. If the CTE is used multiple times in a query it will be run multiple times (possibly with different results).</li>
</ul>
<h2 id="generating-values">generating values <a href="#generating-values" class="anchor" aria-hidden="true">#</a></h2>
<p>Most databases do not have a native way of generating a series of numbers for ad-hoc use; however, common table expressions can be used with recursion to emulate that type of function.</p>
<p>The following example generates a common table expression called <code>Numbers</code> with a column <code>i</code> which has a row for numbers 1-5:</p>
<pre><code>--Give a table name `Numbers&quot; and a column `i` to hold the numbers
WITH Numbers(i) AS (
    --Starting number/index
    SELECT 1
    --Top-level UNION ALL operator required for recursion
    UNION ALL
    --Iteration expression:
    SELECT i + 1
    --Table expression we first declared used as source for recursion
    FROM Numbers
    --Clause to define the end of the recursion
    WHERE i &lt; 5
)
--Use the generated table expression like a regular table
SELECT i FROM Numbers;
</code></pre>
<table>
<thead>
<tr>
<th>i</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
</tr>
<tr>
<td>2</td>
</tr>
<tr>
<td>3</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>5</td>
</tr>
</tbody>
</table>
<p>This method can be used with any number interval, as well as other types of data.</p>
<h2 id="recursively-enumerating-a-subtree">recursively enumerating a subtree <a href="#recursively-enumerating-a-subtree" class="anchor" aria-hidden="true">#</a></h2>
<pre><code>WITH RECURSIVE ManagedByJames(Level, ID, FName, LName) AS (
    -- start with this row
    SELECT 1, ID, FName, LName
    FROM Employees
    WHERE ID = 1

    UNION ALL

    -- get employees that have any of the previously selected rows as manager
    SELECT ManagedByJames.Level + 1,
           Employees.ID,
           Employees.FName,
           Employees.LName
    FROM Employees
    JOIN ManagedByJames
        ON Employees.ManagerID = ManagedByJames.ID

    ORDER BY 1 DESC   -- depth-first search
)
SELECT * FROM ManagedByJames;
</code></pre>
<table>
<thead>
<tr>
<th>Level</th>
<th>ID</th>
<th>FName</th>
<th>LName</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1</strong></td>
<td>1</td>
<td>James</td>
<td>Smith</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>2</td>
<td>John</td>
<td>Johnson</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>4</td>
<td>Johnathon</td>
<td>Smith</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>3</td>
<td>Michael</td>
<td>Williams</td>
</tr>
</tbody>
</table>
<h2 id="temporary-query">Temporary query <a href="#temporary-query" class="anchor" aria-hidden="true">#</a></h2>
<p>These behave in the same manner as nested subqueries but with a different syntax.</p>
<pre><code>WITH ReadyCars AS (
  SELECT *
  FROM Cars
  WHERE Status = 'READY'
)
SELECT ID, Model, TotalCost
FROM ReadyCars
ORDER BY TotalCost;
</code></pre>
<table>
<thead>
<tr>
<th>ID</th>
<th>Model</th>
<th>TotalCost</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Ford F-150</td>
<td>200</td>
</tr>
<tr>
<td>2</td>
<td>Ford F-150</td>
<td>230</td>
</tr>
</tbody>
</table>
<p><strong>Equivalent subquery syntax</strong></p>
<pre><code>SELECT ID, Model, TotalCost
FROM (
  SELECT *
  FROM Cars
  WHERE Status = 'READY'
) AS ReadyCars
ORDER BY TotalCost
</code></pre>
<h2 id="recursively-going-up-in-a-tree">recursively going up in a tree <a href="#recursively-going-up-in-a-tree" class="anchor" aria-hidden="true">#</a></h2>
<pre><code>WITH RECURSIVE ManagersOfJonathon AS (
    -- start with this row
    SELECT *
    FROM Employees
    WHERE ID = 4

    UNION ALL

    -- get manager(s) of all previously selected rows
    SELECT Employees.*
    FROM Employees
    JOIN ManagersOfJonathon
        ON Employees.ID = ManagersOfJonathon.ManagerID
)
SELECT * FROM ManagersOfJonathon;
</code></pre>
<table>
<thead>
<tr>
<th>Id</th>
<th>FName</th>
<th>LName</th>
<th>PhoneNumber</th>
<th>ManagerId</th>
<th>DepartmentId</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>Johnathon</td>
<td>Smith</td>
<td>1212121212</td>
<td><strong>2</strong></td>
<td>1</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>John</td>
<td>Johnson</td>
<td>2468101214</td>
<td><strong>1</strong></td>
<td>1</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>James</td>
<td>Smith</td>
<td>1234567890</td>
<td>NULL</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="recursively-generate-dates-extended-to-include-team-rostering-as-example">Recursively generate dates, extended to include team rostering as example <a href="#recursively-generate-dates-extended-to-include-team-rostering-as-example" class="anchor" aria-hidden="true">#</a></h2>
<pre><code>DECLARE @DateFrom DATETIME = '2016-06-01 06:00'
DECLARE @DateTo DATETIME = '2016-07-01 06:00'
DECLARE @IntervalDays INT = 7

-- Transition Sequence = Rest &amp; Relax into Day Shift into Night Shift
-- RR (Rest &amp; Relax) = 1
-- DS (Day Shift) = 2
-- NS (Night Shift) = 3

;WITH roster AS
(
   SELECT @DateFrom AS RosterStart, 1 AS TeamA, 2 AS TeamB, 3 AS TeamC
   UNION ALL
   SELECT DATEADD(d, @IntervalDays, RosterStart),
          CASE TeamA WHEN 1 THEN 2 WHEN 2 THEN 3 WHEN 3 THEN 1 END AS TeamA,
          CASE TeamB WHEN 1 THEN 2 WHEN 2 THEN 3 WHEN 3 THEN 1 END AS TeamB,
          CASE TeamC WHEN 1 THEN 2 WHEN 2 THEN 3 WHEN 3 THEN 1 END AS TeamC
   FROM roster WHERE RosterStart &lt; DATEADD(d, -@IntervalDays, @DateTo)
)

SELECT RosterStart,
       ISNULL(LEAD(RosterStart) OVER (ORDER BY RosterStart), RosterStart + @IntervalDays) AS RosterEnd,
       CASE TeamA WHEN 1 THEN 'RR' WHEN 2 THEN 'DS' WHEN 3 THEN 'NS' END AS TeamA,
       CASE TeamB WHEN 1 THEN 'RR' WHEN 2 THEN 'DS' WHEN 3 THEN 'NS' END AS TeamB,
       CASE TeamC WHEN 1 THEN 'RR' WHEN 2 THEN 'DS' WHEN 3 THEN 'NS' END AS TeamC
FROM roster
</code></pre>
<p><strong>Result</strong></p>
<p>I.e. For Week 1 TeamA is on R&amp;R, TeamB is on Day Shift and TeamC is on Night Shift.</p>
<p><a href="http://i.stack.imgur.com/rm2xk.jpg"><img class="img-fluid lazyload blur-up" src="http://i.stack.imgur.com/rm2xk.jpg" alt="enter image description here"></a></p>
<h2 id="oracle-connect-by-functionality-with-recursive-ctes">Oracle CONNECT BY functionality with recursive CTEs <a href="#oracle-connect-by-functionality-with-recursive-ctes" class="anchor" aria-hidden="true">#</a></h2>
<p>Oracle&rsquo;s CONNECT BY functionality provides many useful and nontrivial features that are not built-in when using SQL standard recursive CTEs. This example replicates these features (with a few additions for sake of completeness), using SQL Server syntax. It is most useful for Oracle developers finding many features missing in their hierarchical queries on other databases, but it also serves to showcase what can be done with a hierarchical query in general.</p>
<pre><code>  WITH tbl AS (
       SELECT id, name, parent_id
         FROM mytable)
     , tbl_hierarchy AS (
       /* Anchor */
       SELECT 1 AS &quot;LEVEL&quot;
            --, 1 AS CONNECT_BY_ISROOT
            --, 0 AS CONNECT_BY_ISBRANCH
            , CASE WHEN t.id IN (SELECT parent_id FROM tbl) THEN 0 ELSE 1 END AS CONNECT_BY_ISLEAF
            , 0 AS CONNECT_BY_ISCYCLE
            , '/' + CAST(t.id   AS VARCHAR(MAX)) + '/' AS SYS_CONNECT_BY_PATH_id
            , '/' + CAST(t.name AS VARCHAR(MAX)) + '/' AS SYS_CONNECT_BY_PATH_name
            , t.id AS root_id
            , t.*
         FROM tbl t
        WHERE t.parent_id IS NULL                            -- START WITH parent_id IS NULL
       UNION ALL
       /* Recursive */
       SELECT th.&quot;LEVEL&quot; + 1 AS &quot;LEVEL&quot;
            --, 0 AS CONNECT_BY_ISROOT
            --, CASE WHEN t.id IN (SELECT parent_id FROM tbl) THEN 1 ELSE 0 END AS CONNECT_BY_ISBRANCH
            , CASE WHEN t.id IN (SELECT parent_id FROM tbl) THEN 0 ELSE 1 END AS CONNECT_BY_ISLEAF
            , CASE WHEN th.SYS_CONNECT_BY_PATH_id LIKE '%/' + CAST(t.id AS VARCHAR(MAX)) + '/%' THEN 1 ELSE 0 END AS CONNECT_BY_ISCYCLE
            , th.SYS_CONNECT_BY_PATH_id   + CAST(t.id   AS VARCHAR(MAX)) + '/' AS SYS_CONNECT_BY_PATH_id
            , th.SYS_CONNECT_BY_PATH_name + CAST(t.name AS VARCHAR(MAX)) + '/' AS SYS_CONNECT_BY_PATH_name
            , th.root_id
            , t.*
         FROM tbl t
              JOIN tbl_hierarchy th ON (th.id = t.parent_id) -- CONNECT BY PRIOR id = parent_id
        WHERE th.CONNECT_BY_ISCYCLE = 0)                     -- NOCYCLE
SELECT th.*
     --, REPLICATE(' ', (th.&quot;LEVEL&quot; - 1) * 3) + th.name AS tbl_hierarchy
  FROM tbl_hierarchy th
       JOIN tbl CONNECT_BY_ROOT ON (CONNECT_BY_ROOT.id = th.root_id)
 ORDER BY th.SYS_CONNECT_BY_PATH_name;                       -- ORDER SIBLINGS BY name
</code></pre>
<p>CONNECT BY features demonstrated above, with explanations:</p>
<ul>
<li>Clauses
<ul>
<li>CONNECT BY: Specifies the relationship that defines the hierarchy.</li>
<li>START WITH: Specifies the root nodes.</li>
<li>ORDER SIBLINGS BY: Orders results properly.</li>
</ul>
</li>
<li>Parameters
<ul>
<li>NOCYCLE: Stops processing a branch when a loop is detected. Valid hierarchies are Directed Acyclic Graphs, and circular references violate this construct.</li>
</ul>
</li>
<li>Operators
<ul>
<li>PRIOR: Obtains data from the node&rsquo;s parent.</li>
<li>CONNECT_BY_ROOT: Obtains data from the node&rsquo;s root.</li>
</ul>
</li>
<li>Pseudocolumns
<ul>
<li>LEVEL: Indicates the node&rsquo;s distance from its root.</li>
<li>CONNECT_BY_ISLEAF: Indicates a node without children.</li>
<li>CONNECT_BY_ISCYCLE: Indicates a node with a circular reference.</li>
</ul>
</li>
<li>Functions
<ul>
<li>SYS_CONNECT_BY_PATH: Returns a flattened/concatenated representation of the path to the node from its root.</li>
</ul>
</li>
</ul>
<h2 id="refactoring-a-query-to-use-common-table-expressions">Refactoring a query to use Common Table Expressions <a href="#refactoring-a-query-to-use-common-table-expressions" class="anchor" aria-hidden="true">#</a></h2>
<p>Suppose we want to get all product categories with total sales greater than 20.</p>
<p>Here is a query without Common Table Expressions:</p>
<pre><code>SELECT category.description, sum(product.price) as total_sales
FROM sale
LEFT JOIN product on sale.product_id = product.id
LEFT JOIN category on product.category_id = category.id
GROUP BY category.id, category.description
HAVING sum(product.price) &gt; 20
</code></pre>
<p>And an equivalent query using Common Table Expressions:</p>
<pre><code>WITH all_sales AS (
  SELECT product.price, category.id as category_id, category.description as category_description
  FROM sale
  LEFT JOIN product on sale.product_id = product.id
  LEFT JOIN category on product.category_id = category.id
)
, sales_by_category AS (
  SELECT category_description, sum(price) as total_sales
  FROM all_sales
  GROUP BY category_id, category_description
)
SELECT * from sales_by_category WHERE total_sales &gt; 20
</code></pre>
<h2 id="example-of-a-complex-sql-with-common-table-expression">Example of a complex SQL with Common Table Expression <a href="#example-of-a-complex-sql-with-common-table-expression" class="anchor" aria-hidden="true">#</a></h2>
<p>Suppose we want to query the &ldquo;cheapest products&rdquo; from the &ldquo;top categories&rdquo;.</p>
<p>Here is an example of query using Common Table Expressions</p>
<pre><code>-- all_sales: just a simple SELECT with all the needed JOINS
WITH all_sales AS (
  SELECT
  product.price as product_price,
  category.id as category_id,
  category.description as category_description
  FROM sale
  LEFT JOIN product on sale.product_id = product.id
  LEFT JOIN category on product.category_id = category.id
)
-- Group by category
, sales_by_category AS (
  SELECT category_id, category_description,
  sum(product_price) as total_sales
  FROM all_sales
  GROUP BY category_id, category_description
)
-- Filtering total_sales &gt; 20
, top_categories AS (
  SELECT * from sales_by_category WHERE total_sales &gt; 20
)
-- all_products: just a simple SELECT with all the needed JOINS
, all_products AS (
  SELECT
  product.id as product_id,
  product.description as product_description,
  product.price as product_price,
  category.id as category_id,
  category.description as category_description
  FROM product
  LEFT JOIN category on product.category_id = category.id
)
-- Order by product price
, cheapest_products AS (
  SELECT * from all_products
  ORDER by product_price ASC
)
-- Simple inner join 
, cheapest_products_from_top_categories AS (
  SELECT product_description, product_price
  FROM cheapest_products
  INNER JOIN top_categories ON cheapest_products.category_id = top_categories.category_id
)
--The main SELECT
SELECT * from cheapest_products_from_top_categories
</code></pre>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				</div>
			<div class="docs-navigation d-flex justify-content-between">
	
	
		<a href="/sql/create-table/">
						<div class="card my-1">
							<div class="card-body py-2">
								&larr; CREATE TABLE
							</div>
						</div>
					</a>
				<a class="ms-auto" href="/sql/functions-aggregate/">
						<div class="card my-1">
							<div class="card-body py-2">
								Functions (Aggregate) &rarr;
							</div>
						</div>
					</a>
				
	
	</div>

			
		</main>
	</div>

      </div>
    </div>
    
    
    <footer class="footer text-muted">
  <div class="container-xxl">
    <div class="row">
      <div class="col-lg-8 order-last order-lg-first">
        <ul class="list-inline">
          <li class="list-inline-item">Copyright © 2018-2022 Wikiod.</li>
        </ul>
      </div>
      <div class="col-lg-8 order-first order-lg-last text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item"><a href="/about/">About</a></li>
          <li class="list-inline-item"><a href="/disclaimers/">Disclaimers</a></li>
          <li class="list-inline-item"><a href="/dcma/">DCMA</a></li>
          <li class="list-inline-item"><a href="/terms-of-use/">Terms of Use</a></li>
          <li class="list-inline-item"><a href="/privacy-policy/">Privacy Policy</a></li>
          </ul>
      </div>
    </div>
  </div>
</footer>
    

<script src="/js/bootstrap.min.54bf0932b8a36d0e152b1635b099a6ef1394d35327e2437550a075c9c8ed1bd8aed5847c21b36fc02ed24014c031d9ca24017b0c78b1639d7e2fa8329898b842.js" integrity="sha512-VL8JMrijbQ4VKxY1sJmm7xOU01Mn4kN1UKB1ycjtG9iu1YR8IbNvwC7SQBTAMdnKJAF7DHixY51&#43;L6gymJi4Qg==" crossorigin="anonymous" defer></script>
  <script src="/js/highlight.min.56a414730f1135fe77b5ea30bf74a2cc4101a6f386e85e5b789c800570cc33d33054000f45932c053a59b41018f72687867254a80e1b9710671852492533162f.js" integrity="sha512-VqQUcw8RNf53teowv3SizEEBpvOG6F5beJyABXDMM9MwVAAPRZMsBTpZtBAY9yaHhnJUqA4blxBnGFJJJTMWLw==" crossorigin="anonymous" defer></script>
  <script src="/main.min.4971645518aa07968852c38e2c8051abe697181395ad03d5fa0eb28e42edf5f54f801de05c98298ce77b65223caf97b7ea259fbca096e64b3840985ec069e2ef.js" integrity="sha512-SXFkVRiqB5aIUsOOLIBRq&#43;aXGBOVrQPV&#43;g6yjkLt9fVPgB3gXJgpjOd7ZSI8r5e36iWfvKCW5ks4QJhewGni7w==" crossorigin="anonymous" defer></script>
  
    
  </body>
</html>